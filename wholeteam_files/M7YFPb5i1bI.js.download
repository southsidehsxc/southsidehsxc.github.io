if (self.CavalryLogger) { CavalryLogger.start_js(["ZhxCB"]); }

__d("BlueBarFocusListener",["CSS","Deferred","Event"],(function a(b,c,d,e,f,g){__p&&__p();var h="f_key",i="f_click",j=null,k=function k(){j=null};function l(r){c("CSS").removeClass(r,h);c("CSS").removeClass(r,i)}function m(r){if(j)j.reject();j=new(c("Deferred"))();j.then(function(s){l(r);c("CSS").addClass(r,s)}).done(k,k)}function n(){if(j)j.resolve(h)}function o(r){if(j)j.reject();c("CSS").removeClass(r,h);c("CSS").addClass(r,i)}function p(r){return function(event){r(event.getTarget())}}var q={listen:function r(s){if(!s)return;c("Event").listen(s,"focusout",p(l));c("Event").listen(s,"focusin",p(m));c("Event").listen(s,"click",p(o));c("Event").listen(s,"keyup",n)}};f.exports=q}),null);
__d("RoyalBluebarTransitions",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({INDETERMINATE:"Indeterminate",PULSE:"Pulse",SHIMMER:"Shimmer",NONE:"none",OFF:"off"})}),null);
__d("RoyalBluebar",["cx","Arbiter","BigPipe","CSS","Event","QuicklingFetchStreamConfig","RoyalBluebarTransitions","Run","SubscriptionsHandler","ge","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=null,j=false,k=c("QuicklingFetchStreamConfig"),l=k.experimentName,m=l!==c("RoyalBluebarTransitions").OFF&&l!==c("RoyalBluebarTransitions").NONE;function n(){i&&i()}var o={_subscriptionHandler:null,_getSubscriptionHandler:function p(){if(!this._subscriptionHandler){this._subscriptionHandler=new(c("SubscriptionsHandler"))();c("Run").onUnload(function(){this._subscriptionHandler.release();this._subscriptionHandler=null}.bind(this))}return this._subscriptionHandler},fixOnScroll:function p(q){this._getSubscriptionHandler().addSubscriptions(c("Arbiter").subscribe("bluebarFixedBehaviorController/isfixed",function(r,s){var t="_50ti",u="_33rf";if(q.firstChild instanceof Element)c("CSS").conditionClass(q.firstChild,t,s);if(q.firstChild instanceof Element)c("CSS").conditionClass(q.firstChild,u,!s);c("Arbiter").inform("reflow")}))},informOnClick:function p(q){this._getSubscriptionHandler().addSubscriptions(c("Event").listen(q,"click",function(event){if(c("Arbiter").inform("BlueBar/homeClick",event)===false)event.preventDefault()}))},stopAnimatingAfterDD:function p(){var q=c("Arbiter").subscribeOnce(c("BigPipe").Events.init,function(s,t){t.arbiter.subscribeOnce(c("BigPipe").Events.displayed,n)}),r=c("Run").onAfterLoad(n);i=function s(){i=null;c("Arbiter").unsubscribe(q);r.remove();o.stopTransitionAnimation()}},startTransitionAnimation:function p(){if(m){i&&i();var q=c("ge")(k.bluebarTransitionElement);if(q)c("CSS").addClass(q,k.bluebarTransitionClass)}},stopTransitionAnimation:function p(){__p&&__p();var q;if(m){var q=function(){__p&&__p();var r,s=k,t=c("ge")(s.bluebarTransitionElement);if(!t)return{v:void 0};if(l===c("RoyalBluebarTransitions").INDETERMINATE){if(!j)(function(){__p&&__p();j=true;c("CSS").addClass(t,"finishing");var u=void 0;i=function v(){i=null;j=false;clearTimeout(u);c("CSS").removeClass(t,"finishing");c("CSS").removeClass(t,s.bluebarTransitionClass)};u=c("setTimeoutAcrossTransitions")(i,200)})()}else c("CSS").removeClass(t,s.bluebarTransitionClass)}();if(typeof q==="object")return q.v}}};f.exports=o}),null);
__d("NotificationConstants",[],(function a(b,c,d,e,f,g){f.exports={PayloadSourceType:{UNKNOWN:0,USER_ACTION:1,LIVE_SEND:2,ENDPOINT:3,INITIAL_LOAD:4,OTHER_APPLICATION:5,SYNC:6,CLIENT:7}}}),null);
__d("NotificationSeenFilter",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ALL:"all",SEEN_ONLY:"seen_only",UNSEEN_ONLY:"unseen_only",READ_ONLY:"read_only",UNREAD_ONLY:"unread_only",SEEN_BUT_UNREAD_ONLY:"seen_unread_only"})}),null);
__d("NotificationPhotoThumbnail",["NotificationAttachmentConfig"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(j){if(!j.media||!j.style_list||!j.style_list.length)return null;var k=j.style_list[0];if(c("NotificationAttachmentConfig").thumbnailStyles[k])return j.media.image;return null}var i={getThumbnailForNotification:function j(k){var l=k.attachments,m=k.attached_story,n=k.feedback_context;return i.getThumbnail(l,m,n)},getThumbnail:function j(k,l,m){__p&&__p();var n=void 0;if(k&&k.length){k.some(function(r){n=h(r);if(n)return true;return false});if(n)return n}if(m){var o=m.relevant_comments;if(o&&o.length){var p=o[0].attachments;if(p&&p.length){n=h(p[0]);if(n)return n}}}if(l){var q=l.attachments;if(q&&q.length)return h(q[0])}return null}};f.exports=i}),null);
__d("NotificationAttachmentUtils",["NotificationAttachmentConfig"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={shouldOpenSnowlift:function i(j){__p&&__p();var k=j.attachments,l=j.feedback_context,m=j.attached_story,n=[];if(k)n.push.apply(n,k);if(l&&l.relevant_comments){var o=l.relevant_comments;o.reduce(function(p,q){return p.concat(q.attachments)},n)}if(m&&m.attachments)n.push.apply(n,m.attachments);return n.some(function(p){if(!p.style_list||!p.style_list.length)return false;var q=p.style_list[0];return!!c("NotificationAttachmentConfig").snowliftStyles[q]})}};f.exports=h}),null);
__d("NotificationURI",["BusinessURI.brands","URI","VideoPermalinkURI","isFacebookURI"],(function a(b,c,d,e,f,g){__p&&__p();var h={localize:function i(j){try{j=c("BusinessURI.brands")(j)}catch(k){return j.toString()}var l=j.getSubdomain();return j.getUnqualifiedURI().getQualifiedURI().setSubdomain(l).toString()},snowliftable:function i(j){if(!j)return false;var k=new(c("URI"))(j),l=k.getQueryData();return c("isFacebookURI")(k)&&(c("VideoPermalinkURI").isValid(k)||"fbid"in l)},isVaultSetURI:function i(j){return this._areEquals(j,"/ajax/vault/sharer_preview.php")},isAlbumDraftRecoveryDialogURI:function i(j){return this._areEquals(j,"/ajax/photos/upload/overlay/")},isQuicksilverURI:function i(j){return this._areEquals(j,"/games/quicksilver/spotlight/")},isDirectURI:function i(j){return this._startsWith(j,"/direct/")},isIGAccountCreationURI:function i(j){return this._areEquals(j,"/ads/growth/aymt/instagram/account-creation-dialog/")},_areEquals:function i(j,k){if(!j)return false;var l=new(c("URI"))(j);return c("isFacebookURI")(l)&&l.getPath()===k},_startsWith:function i(j,k){if(!j)return false;var l=new(c("URI"))(j);return c("isFacebookURI")(l)&&l.getPath().startsWith(k)}};f.exports=h}),null);
__d("NotificationUtils",["NotificationAttachmentUtils","NotificationURI","URI"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(l){return!!(l&&l.can_render_in_tahoe)}function i(l){return!!(l&&l.bucket_data)}function j(l){return!!(l&&l.video_channel_id)&&!h(l)}var k={getLinkProps:function l(m){__p&&__p();var n=c("NotificationURI").localize(new(c("URI"))(m.url)),o=n;if(j(m.rendererData)||h(m.rendererData)||i(m.rendererData))return{href:o};var p=c("NotificationAttachmentUtils").shouldOpenSnowlift(m)&&c("NotificationURI").snowliftable(n),q=c("NotificationURI").isAlbumDraftRecoveryDialogURI(n),r=p||q?n:m.ajaxify_url||"",s=null;if(p)s="theater";else if(q)s="async-post";else if(c("NotificationURI").isQuicksilverURI(r)||c("NotificationURI").isIGAccountCreationURI(r))s="dialog-post";else if(c("NotificationURI").isDirectURI(n))s="async";else if(r)s="dialog";return{ajaxify:r,href:o,rel:s}}};f.exports=k}),null);
__d("normalizeNotificationPayload",["ix","NotificationPhotoThumbnail","NotificationUtils","idx"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();function i(j){__p&&__p();var k;if(Array.isArray(j.classifications))j.classifications=j.classifications.map(function(u){return u.toUpperCase()});if(Array.isArray(j.eligible_buckets))j.eligible_buckets=j.eligible_buckets.map(function(u){return u.toUpperCase()});if(Object.prototype.hasOwnProperty.call(j,"menu_options")){var l=j,m=l.menu_options;delete l.menu_options;j.notif_option_sets={edges:m&&[{node:{notif_options:{edges:m&&m.map(function(u){return{node:{client_info:{action_type:u.client_action,undo_server_action:u.undo_server_action},server_action:u.server_action,option_display:{text:{text:u.text},subtext:u.subtext!=null?{text:u.subtext}:null,undo_text:u.undo_text}}}})}}}]}}if(Object.prototype.hasOwnProperty.call(j,"previewImage")===false){var n=j,o=c("NotificationPhotoThumbnail").getThumbnailForNotification(n);j.previewImage=o}if(Object.prototype.hasOwnProperty.call(j,"primerAttributes")===false){var p=j,q=c("NotificationUtils").getLinkProps(p);j.primerAttributes={ajaxify:q.ajaxify===undefined?undefined:q.ajaxify,rel:q.rel};delete p.ajaxify_url}if(Object.prototype.hasOwnProperty.call(j,"renderer_data")===false)(function(){__p&&__p();var l=j,u=l.rendererData;if(u&&(Object.prototype.hasOwnProperty.call(u,"bucket_data")||Object.prototype.hasOwnProperty.call(u,"bucket_id")||Object.prototype.hasOwnProperty.call(u,"can_render_in_tahoe")||Object.prototype.hasOwnProperty.call(u,"owner_id")||Object.prototype.hasOwnProperty.call(u,"sender_id")||Object.prototype.hasOwnProperty.call(u,"time_to_hide")||Object.prototype.hasOwnProperty.call(u,"video_channel_caller")||Object.prototype.hasOwnProperty.call(u,"video_channel_id")||Object.prototype.hasOwnProperty.call(u,"video_id"))||l.notif_type==="live_video_explicit"||l.notif_type==="live_video_share"||l.notif_type==="live_video"||l.notif_type==="live_with_video_explicit"||l.notif_type==="live_with_video")j.renderer_data=babelHelpers["extends"]({__typename:"LiveVideoNotificationRendererData"},u,{beeper_time_to_hide:u==null?null:u.time_to_hide,bucket_data:u==null?null:function(){try{return JSON.stringify(u.bucket_data)}catch(w){return null}}()});else if(l.notif_type==="accept_gifted_game"||l.notif_type==="app_content_update"||l.notif_type==="app_invite"||l.notif_type==="app_notification"||l.notif_type==="app_request"||l.notif_type==="decline_gifted_game"||l.notif_type==="send_game_as_gift"){var v=l.app_request_ids;j.renderer_data={__typename:"AppRequestNotificationRendererData",app_request_ids:v?v.split(","):[]}}else j.renderer_data={__typename:"FallbackNotificationRendererData",should_log_menu_exposure:!!(u&&u.logMenuExposure)}})();if(Object.prototype.hasOwnProperty.call(j,"thumbnail")===false){var r,s=j,t=(r=s)!=null?(r=r.actors)!=null?(r=r[0])!=null?(r=r.profile_picture)!=null?r.uri:r:r:r:r;j.thumbnail={uri:t==null?h("97000"):t}}return j}f.exports=i}),null);
__d("normalizeNotificationUpdatePayload",["normalizeNotificationPayload"],(function a(b,c,d,e,f,g){"use strict";function h(i){i=i;if(i.nodes!=null&&Array.isArray(i.nodes))i.nodes=i.nodes.map(c("normalizeNotificationPayload"));return i}f.exports=h}),null);
__d("once",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(j){var k=i(j);for(var l in j)if(Object.prototype.hasOwnProperty.call(j,l))k[l]=j[l];return k}function i(j){var k=j,l=void 0,m=function m(){if(k){l=k.apply(this,arguments);k=null}return l};return m}f.exports=h}),null);
__d("NotificationServerTransport",["invariant","DOM","UIPagelet","compactArray","ifRequired","normalizeNotificationUpdatePayload","objectValues","once","promiseFinally","setImmediateAcrossTransitions","uniqueID"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i={},j={},k={},l={};function m(w){if(l[w]==null){l[w]=c("DOM").create("div",{"class":"hidden_elem",id:w});c("DOM").appendContent(document.documentElement,l[w])}return l[w].id}function n(w){return w.reduce(function(x,y){var z=y.targetNumToLoad;return Math.max(x,z)},0)}function o(w,x,y,z){var A=i[x];if(!A||A.clientRequestID!==w)return;A.calls.forEach(function(B){var C=B.onError;if(C)C(z)})}function p(w,x){__p&&__p();var y=x.getHash(),z=i[y];if(!z||z.clientRequestID!==w)return;delete i[y];z.calls.forEach(function(A){var B=A.onCompleted;if(B)B()});if(j[y]!=null)q(x)}function q(w){__p&&__p();var x=w.getHash();if(k[x]!=null)return;k[x]=c("setImmediateAcrossTransitions")(function(){__p&&__p();delete k[x];var y=c("uniqueID")(),z=j[x];delete j[x];if(z==null)return;var A=n(z),B=w.getRequestParams(A);if(B.length<=0){z.forEach(function(F){var G=F.onCompleted;if(G)G()});return}var C=o.bind(this,y,x,w),D=w.getStreamingTransportPageletName();D!=null||h(0);var E=c("UIPagelet").loadFromEndpoint(D,m(y),babelHelpers["extends"]({},B,{clientRequestID:y}),{allowIrrelevantRequests:true,automatic:false,crossPage:true,errorHandler:C,jsNonblock:true,transportErrorHandler:C,usePipe:true,usePostRequest:false});i[x]={calls:z,clientRequestID:y,endpointState:w,transport:E}}.bind(this))}var r={makeRequest:function w(x,y,z){__p&&__p();var A=z.onChunkResponse,B=z.onCompleted,C=z.onError,D=x.getHash(),E={onChunkResponse:A,onCompleted:B,onError:C,targetNumToLoad:y};v(D);var F=i[D],G=F?n(F.calls)>=y:false;if(G){F!=null||h(0);F.calls.push(E)}else{if(j[D]==null)j[D]=[];j[D].push(E);if(F==null)q(x)}return{remove:function H(){__p&&__p();var F=i[D];if(F!=null){var I=F.calls.indexOf(E);if(I!==-1)F.calls.splice(I,1);if(F.calls.length===0){if(F.transport)F.transport.abandon();delete i[D];if(j[D]!=null)q(x)}}var J=j[D];if(J!=null){var K=J.indexOf(E);if(K!==-1)J.splice(K,1)}}}},handleResponseChunk:function w(x,y){var z=s(x);z.forEach(function(A){A(c("normalizeNotificationUpdatePayload")(y))})},handleRequestCompleted:function w(x){var y=c("objectValues")(i).find(function(y){return y&&y.clientRequestID===x});y||h(0);p(x,y.endpointState)}};function s(w){__p&&__p();var x=Object.keys(i).find(function(B){var C=i[B];return C&&C.clientRequestID===w}),y=x&&i[x];if(!y||!x)return[];var z=y.calls,A=j[x];if(A)z=z.concat(A);return c("compactArray")(z.map(function(B){return B.onChunkResponse}))}function t(w,x){__p&&__p();var y=x.targetNumToLoad,z=x.endpointState,A=x.payloadPromise;if(i[w]!=null)return;var B=c("uniqueID")(),C={calls:[{targetNumToLoad:y}],clientRequestID:B,endpointState:z};i[w]=C;var D=A.then(function(E){var F=s(B);F.forEach(function(G){G(E)})});c("promiseFinally")(D,function(){p(B,z)}).done()}var u=function u(w){c("ifRequired")("NotificationEagerLoader",function(x){var y=x.eagerlyLoadedData;if(y.hasData&&w===y.endpointState.getHash())t(w,y)})},v=c("once")(u);f.exports=r}),null);
__d("NotificationServerTransportLegacy",["AsyncRequest","normalizeNotificationUpdatePayload"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={makeRequest:function i(j,k,l){__p&&__p();var m=l.onError,n=l.onChunkResponse,o=l.onCompleted,p=true;function q(u){if(!p)return;var v=c("normalizeNotificationUpdatePayload")(u.getPayload());try{n(v)}finally{o()}}function r(u){if(!p)return;if(m)m(u)}var s=j.getRequestParams(k);if(s.length<=0){o();return{remove:function u(){}}}var t=new(c("AsyncRequest"))(j.endpointURI).setAllowCrossPageTransition(true).setData(s).setErrorHandler(r).setTransportErrorHandler(r).setHandler(q);t.send();return{remove:function u(){p=false;t.abandon()}}}};f.exports=h}),null);
__d("sortBy",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i,j){__p&&__p();var k=i.map(function(l,m){return{index:m,sortValue:j(l),value:l}});k.sort(function(l,m){var n=l.sortValue,o=m.sortValue;if(n>o)return 1;if(n<o)return-1;return l.index-m.index});return k.map(function(l){return l.value})}f.exports=h}),null);
__d("NotificationStore",["ErrorUtils","NotificationConstants","NotificationEndpointState","NotificationListConfig","NotificationsDefaultEndpointURI","NotificationServerTransport","NotificationServerTransportLegacy","NotificationUpdates","QE2Logger","createObjectBy","distinctArrayBy","flatMapArray","objectValues","sortBy","sprintf"],(function a(b,c,d,e,f,g){__p&&__p();var h={};function i(p,q,r){return p.page_info!=null&&q.classification==r.classification&&q.endpointURI===r.endpointURI&&q.filter==r.filter}function j(p){if(!p.eligible_buckets||!p.eligible_buckets.includes("PRIORITY_INBOX"))p.eligible_buckets=["PRIORITY_INBOX"].concat(p.eligible_buckets||[]);if(!p.sort_keys){var q=p.creation_time||Date.now()/1e3;p.sort_keys=[""+q,q+"000000"]}return p}function k(p){if(p.nodes&&p.payloadsource===c("NotificationConstants").PayloadSourceType.LIVE_SEND)return babelHelpers["extends"]({},p,{nodes:p.nodes.map(j)});return p}function l(p,q){__p&&__p();p=k(p);var r={};c("NotificationEndpointState").getAllInstances(q.endpointURI).forEach(function(s){__p&&__p();var t=void 0;if(i(p,s,q)){s.graphQLPageInfo=p.page_info;t=p}else if(p.payloadsource===c("NotificationConstants").PayloadSourceType.SYNC&&q.endpointURI===c("NotificationsDefaultEndpointURI")&&s.classification==null&&s.filter==null)t=p;else t=babelHelpers["extends"]({},p,{nodes:p.nodes?p.nodes.filter(function(v){return m(v,s)}):undefined});if(t.nodes&&t.nodes.length>0){var u=n(s,t);if(u!=null)u.forEach(function(v){r[v]=true})}});c("NotificationUpdates").didUpdateNotifications(Object.keys(r))}function m(p,q){__p&&__p();var r=q.classification,s=q.filter,t=q.notifications,u=q.order,v=u.getAllResources();v.length===0;if(v.length>0){var w=v[0],x=t.getResource(w);if(x.creation_time>=p.creation_time)return false}if(r&&(!p.classifications||!p.classifications.includes(r)))return false;if(s&&s==="read"!==(p.seen_state==="SEEN_AND_READ"))return false;return true}function n(p,q){__p&&__p();var r=[],s={};if(q.nodes&&q.nodes.length>0)q.nodes.forEach(function(t){var u=t.alert_id,v=p.notifications.getResource(u);if(!v||v.creation_time<t.creation_time){r.push(u);s[u]=t}});p.notifications.addResourcesAndExecute(s);p.order.addResources(r);return r}c("NotificationUpdates").subscribe("update-notifications",function(p,q){if(q.payloadsource!==c("NotificationConstants").PayloadSourceType.ENDPOINT)l(q,{endpointURI:q.endpoint!=null?q.endpoint:c("NotificationsDefaultEndpointURI")})});var o={getNotifications:function p(q,r,s){__p&&__p();var t=c("NotificationEndpointState").getInstance(r),u=t.notifications,v=t.order,w=void 0,x=v.executeOrEnqueue(0,q,function(G){if(s){w=u.executeOrEnqueue(G,s);var H=u.getUnavailableResources(w);if(H.length>0)c("ErrorUtils").reportError(new Error(c("sprintf")("The range for this endpoint contained notification IDs for which we have no payload (Notification IDs: `%s`. Endpoint config: `%s`).",JSON.stringify(H),JSON.stringify(t.getConfig()))))}});function y(){v.unsubscribe(x);if(w)u.unsubscribe(w)}if(v.getUnavailableResources(x).length===0)return{remove:y};if(!o.canFetchMore(r)){v.forceRunCallbacks();return{remove:y}}var z=t.getHash();if(h[z]==null)h[z]=1;else h[z]++;function A(){h[z]--;if(h[z]===0)v.forceRunCallbacks()}function B(G){if(!(G&&G.nodes))return;c("NotificationUpdates").handleUpdate(c("NotificationConstants").PayloadSourceType.ENDPOINT,G,r.filter,r.classification);l(babelHelpers["extends"]({},G,{payloadsource:c("NotificationConstants").PayloadSourceType.ENDPOINT}),r)}function C(){h[z]--;if(h[z]===0)v.forceRunCallbacks()}var D=void 0;if(c("NotificationListConfig").useStreamingTransport&&t.getStreamingTransportPageletName()!=null)D=c("NotificationServerTransport");else D=c("NotificationServerTransportLegacy");if(r.endpointURI===c("NotificationsDefaultEndpointURI"))c("QE2Logger").logExposureForUser("www_notifications_perf_h2_2017");var E=D.makeRequest(t,q,{onChunkResponse:B,onCompleted:C,onError:A}),F=E.remove;return{remove:function G(){y();F()}}},getNotification:function p(q){var r=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],s=r.classification,t=r.endpointURI,u=t===undefined?c("NotificationsDefaultEndpointURI"):t,v=r.filter,w=c("NotificationEndpointState").getInstance({classification:s,endpointURI:u,filter:v}),x=w.notifications;return x.getResource(q)},getAllForAllEndpoints:function p(){var q=c("NotificationEndpointState").getAllInstances(),r=c("flatMapArray")(q,function(v){var w=this.getAll(v.getConfig());return c("objectValues")(w)}.bind(this)),s=c("sortBy")(r,function(v){return v.creation_time}),t=s.reverse(),u=c("distinctArrayBy")(t,function(v){return v.alert_id});return c("createObjectBy")(u,function(v){return v.alert_id})},getAll:function p(q){var r=c("NotificationEndpointState").getInstance(q),s=r.notifications,t=r.order,u={};t.getAllResources().forEach(function(v){var w=s.getResource(v);if(w==null)c("ErrorUtils").reportError(new Error(c("sprintf")("The range for this endpoint contained a notification ID for which we have no payload (Notification ID: `%s`. Endpoint config: `%s`).",v,JSON.stringify(q))));else u[v]=w});return u},getCount:function p(q){var r=c("NotificationEndpointState").getInstance(q);return r.order.getAllResources().length},canFetchMore:function p(q){var r=c("NotificationEndpointState").getInstance(q),s=r.graphQLPageInfo;return!s||!Object.prototype.hasOwnProperty.call(s,"has_next_page")||s.has_next_page},registerEndpoint:function p(q){c("NotificationEndpointState").getInstance(q)}};o.registerEndpoint({endpointURI:c("NotificationsDefaultEndpointURI")});f.exports=o}),null);
__d("NotificationTokens",["CurrentUser"],(function a(b,c,d,e,f,g){var h={tokenizeIDs:function i(j){return j.map(function(k){return c("CurrentUser").getID()+":"+k})},untokenizeIDs:function i(j){return j.map(function(k){return k.split(":")[1]})}};f.exports=h}),null);
__d("NotificationUpdates",["Arbiter","AsyncRequest","BusinessUserConf","ChannelConstants","JSLogger","LiveTimer","NotificationConstants","NotificationTokens","createObjectFrom","normalizeNotificationUpdatePayload","NotificationStore"],(function a(b,c,d,e,f,g){__p&&__p();var h={},i={},j={},k={},l=false,m=[],n=0,o=void 0,p=new(c("Arbiter"))(),q=c("JSLogger").create("notification_updates");function r(){__p&&__p();if(n)return;var w=h,x=i,y=j,z=k;h={};i={};j={};k={};if(Object.keys(w).length||l){l=false;t("notifications-updated",w)}if(Object.keys(x).length)t("seen-state-updated",x);if(Object.keys(y).length)t("read-state-updated",y);if(Object.keys(z).length)t("hidden-state-updated",z);m.pop()}function s(){if(m.length)return m[m.length-1];return c("NotificationConstants").PayloadSourceType.UNKNOWN}function t(event,w){v.inform(event,{updates:w,source:s()})}var u=null,v={getserverTime:function w(){return u},setEndPoint:function w(x){o=x},handleUpdate:function w(x,y,z,A){__p&&__p();y=c("normalizeNotificationUpdatePayload")(y);if(y.nodes&&Array.isArray(y.nodes))y.nodes=this._filterNodesBasedOnBusinessUser(y.nodes,c("BusinessUserConf").businessUserID);if(y.servertime){u=y.servertime;c("LiveTimer").restart(y.servertime)}var B=y.nodes;if(o&&x===c("NotificationConstants").PayloadSourceType.LIVE_SEND&&B&&Array.isArray(B)&&B.length>0){var C=c("NotificationStore"),D={classification:A,endpointURI:o,filter:z};if(C.getCount(D)>0||!C.canFetchMore(D))return;new(c("AsyncRequest"))(o).setAllowCrossPageTransition(true).setData({businessUserID:c("BusinessUserConf").businessUserID,classification:A!=null?A.toLowerCase():null,filter:z,length:B.length}).setHandler(function(E){__p&&__p();var y=E.getPayload();if(y==null)return;var F=y.nodes;if(F==null||F.length===0)return;var G={};F.forEach(function(H){var I=H.alert_id;G[I]=true});y.nodes=B.filter(function(H){var I=H.alert_id;return G[I]===true});if(y.nodes.length>0)this._updateWithPayload(x,y)}.bind(this)).send()}else this._updateWithPayload(x,y)},_updateWithPayload:function w(x,y){if(Object.keys(y).length)this.synchronizeInforms(function(){m.push(x);var z=babelHelpers["extends"]({},y,{payloadsource:s()});this.inform("update-notifications",z);this.inform("update-seen",z);this.inform("update-read",z);this.inform("update-hidden",z)}.bind(this))},getArbiter:function w(){return p},inform:function w(event,x){return p.inform(event,x)},subscribe:function w(event,x){return p.subscribe(event,x)},didUpdateNotifications:function w(x){Object.assign(h,c("createObjectFrom")(x));l=true;r()},didUpdateSeenState:function w(x){Object.assign(i,c("createObjectFrom")(x));r()},didUpdateReadState:function w(x){Object.assign(j,c("createObjectFrom")(x));r()},didUpdateHiddenState:function w(x){Object.assign(k,c("createObjectFrom")(x));r()},synchronizeInforms:function w(x){n++;try{x()}catch(y){throw y}finally{n--;r()}},_filterNodesBasedOnBusinessUser:function w(x,y){return x.filter(function(z){return y==z.biz_user_id})}};c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("notification_json"),function(w,x){var y=Date.now(),z=x.obj.nodes;if(z){z.forEach(function(B){B.receivedTime=y});q.debug("notifications_received",z);var A=x.obj.servertime;v.handleUpdate(c("NotificationConstants").PayloadSourceType.LIVE_SEND,{nodes:z,servertime:A})}});c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("notifications_seen"),function(w,x){var y=c("NotificationTokens").tokenizeIDs(x.obj.alert_ids),z=x.obj.new_state;v.handleUpdate(c("NotificationConstants").PayloadSourceType.LIVE_SEND,{seenState:c("createObjectFrom")(y,z)})});c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("notifications_read"),function(w,x){var y=c("NotificationTokens").tokenizeIDs(x.obj.alert_ids),z=x.obj.new_state;v.handleUpdate(c("NotificationConstants").PayloadSourceType.LIVE_SEND,{readState:c("createObjectFrom")(y,z)})});c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("notification_hidden"),function(w,x){var y=c("NotificationTokens").tokenizeIDs([x.obj.notif_id+""]),z=x.obj.state===1;v.handleUpdate(c("NotificationConstants").PayloadSourceType.LIVE_SEND,{hiddenState:c("createObjectFrom")(y,z)})});f.exports=v}),null);
__d("NotificationSeenState",["NotificationConstants","NotificationSeenFilter","NotificationUpdates","createObjectFrom","ifRequired","objectValues"],(function a(b,c,d,e,f,g){__p&&__p();var h=1,i=2,j=0,k=h,l=3,m=c("NotificationConstants").PayloadSourceType.INITIAL_LOAD,n={SEEN_AND_READ:l,SEEN_BUT_UNREAD:k,UNSEEN_AND_UNREAD:j},o={};c("ifRequired")("NotificationStore",function(t){var u=t.getAllForAllEndpoints(),v=c("objectValues")(u),w=q(v);Object.keys(w).forEach(function(x){var y=w[x];o[x]=y})});function p(t){__p&&__p();var u=[],v=[];Object.keys(t).forEach(function(w){__p&&__p();var x=t[w],y=o[w];o[w]=x;if(y===undefined){u.push(w);v.push(w);return}var z=y^x;if(z&h)u.push(w);if(z&i)v.push(w)});u.length&&c("NotificationUpdates").didUpdateSeenState(u);v.length&&c("NotificationUpdates").didUpdateReadState(v)}c("NotificationUpdates").subscribe("update-notifications",function(t,u){var v=u.nodes;if(!v||!v.length)return;var w=u.payloadsource,x=c("NotificationConstants").PayloadSourceType,y=w==x.ENDPOINT,z=v.filter(function(B){var C=B.alert_id;return!y||o[C]===undefined}),A=q(z);p(A)});function q(t){var u={};t.forEach(function(v){if(v.seen_state)u[v.alert_id]=n[v.seen_state]});return u}c("NotificationUpdates").subscribe("update-seen",function(t,u){__p&&__p();if(!u.seenState)return;var v=[],w={};Object.keys(u.seenState).forEach(function(y){if(!u.seenState||!u.seenState[y]){v.push(y);return}var z=o[y];if(z!==undefined)w[y]=z|h});var x=babelHelpers["extends"]({},c("createObjectFrom")(v,j),w);p(x)});c("NotificationUpdates").subscribe("update-read",function(t,u){__p&&__p();if(!u.readState)return;var v=[],w={};Object.keys(u.readState).forEach(function(y){__p&&__p();if(!u.readState)return;var z=u.readState[y];if(z){v.push(y);return}var A=o[y];if(A!==undefined)w[y]=A&~i;else if(u.payloadsource==m)w[y]=k});var x=babelHelpers["extends"]({},c("createObjectFrom")(v,l),w);p(x)});function r(t){var u=o[t];return u}var s={isRead:function t(u){return r(u)===l},isSeen:function t(u){return r(u)!==j},getUnseenCount:function t(){return s.getUnseenIDs().length},getUnseenIDs:function t(){return Object.keys(o).filter(function(u){return o[u]===j})},getUnreadCount:function t(){return s.getUnreadIDs().length},getUnreadIDs:function t(){return Object.keys(o).filter(function(u){return o[u]!==l})},validateFilter:function t(u,v){switch(v){case c("NotificationSeenFilter").SEEN_ONLY:return s.isSeen(u);case c("NotificationSeenFilter").UNSEEN_ONLY:return!s.isSeen(u);case c("NotificationSeenFilter").READ_ONLY:return s.isRead(u);case c("NotificationSeenFilter").UNREAD_ONLY:return!s.isRead(u);case c("NotificationSeenFilter").SEEN_BUT_UNREAD_ONLY:return s.isSeen(u)&&!s.isRead(u);default:return true}}};f.exports=s}),6);
__d("NotificationJewelControllerModuleLoader",["JSResource","NotificationSeenState","NotificationStore","NotificationUpdates"],(function a(b,c,d,e,f,g){c("NotificationSeenState");c("NotificationStore");c("NotificationUpdates");f.exports=c("JSResource")("NotificationJewelController").__setRef("NotificationJewelControllerModuleLoader")}),null);
__d("NotificationOptionActionWebGraphQLMutation",["WebGraphQLMutationBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLMutationBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1420844941369152"};j.getQueryID=function(){"use strict";return"318967338567215"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("NotificationUserActions",["AsyncRequest","Bootloader","BusinessUserConf","CurrentUser","NotificationConstants","NotificationOptionActionWebGraphQLMutation","NotificationTokens","NotificationUpdates","WebGraphQL","createObjectFrom"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("NotificationConstants").PayloadSourceType.USER_ACTION,i=false;function j(m){if(c("BusinessUserConf").businessUserID!=null)m.biz_user_id=c("BusinessUserConf").businessUserID;new(c("AsyncRequest"))("/ajax/notifications/mark_read.php").setData(m).setAllowCrossPageTransition(true).send()}function k(m){var n={};m.forEach(function(o,p){n["alert_ids["+p+"]"]=o});return n}var l={markNotificationsAsSeen:function m(n){var o=document.getElementById("notificationsCountValue"),p=null;if(o)p=o.textContent;c("NotificationUpdates").handleUpdate(h,{seenState:c("createObjectFrom")(n)});var q=c("NotificationTokens").untokenizeIDs(n),r=k(q);r.seen=true;if(p)r.badgeCount=p;j(r)},setNextIsFromReadButton:function m(n){i=n},markNotificationsAsRead:function m(n,o){c("NotificationUpdates").handleUpdate(h,{readState:c("createObjectFrom")(n,true)});var p=c("NotificationTokens").untokenizeIDs(n),q=k(p);if(i){q.from_read_button=true;i=false}if(o)q.source_view=o;j(q)},markNotificationsAsUnread:function m(n,o){__p&&__p();c("NotificationUpdates").handleUpdate(h,{readState:c("createObjectFrom")(n,false)});var p=c("NotificationTokens").untokenizeIDs(n),q=k(p);if(i){q.from_read_button=true;i=false}q.unread=true;if(o)q.source_view=o;j(q)},markAllNotificationsAsRead:function m(){__p&&__p();c("Bootloader").loadModules(["NotificationSeenState"],function(n){var o=n.getUnreadIDs();if(o.length>0)c("NotificationUpdates").handleUpdate(h,{readState:c("createObjectFrom")(o)});var p={read:true};if(i){p.from_read_button=true;i=false}j(p)},"NotificationUserActions")},sendNotifOption:function m(n){return c("WebGraphQL").exec(new(c("NotificationOptionActionWebGraphQLMutation"))({input:{action_type:n,actor_id:c("CurrentUser").getID(),client_mutation_id:"0"}}))}};f.exports=l}),null);
__d("NotificationJewelHeaderController",["DOM","Event","NotificationSeenState","NotificationUpdates","NotificationUserActions"],(function a(b,c,d,e,f,g){function h(i,j){"use strict";c("Event").listen(i,"click",function(){c("NotificationUserActions").markAllNotificationsAsRead()});c("NotificationUpdates").subscribe("read-state-updated",function(){if(j)c("DOM").setContent(j,c("NotificationSeenState").getUnreadCount())})}f.exports=h}),null);
__d("NotificationUpNext",["Bootloader","DOMQuery","NotificationsDefaultEndpointURI","QE2Logger","React","ReactDOM","Toggler","ge","ifRequired"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="fbNotificationsJewel",i={initialize:function j(k){__p&&__p();var l=arguments.length<=1||arguments[1]===undefined?{endpointURI:c("NotificationsDefaultEndpointURI")}:arguments[1];c("Bootloader").loadModules(["NotificationUpNextStore","NotificationUpNextDialog.react"],function(m,n){__p&&__p();if(k.shouldExpose&&k.universeName)m.subscribe(function(){c("QE2Logger").logExposureForUser(k.universeName)});m.setTriggerAction(k.triggerAction);m.setSupportedBucketType(k.supportedBucket);m.setLooping(k.loop);var o=k.data;if(!o)return;m.setMaxAge(o.maxAgeInSecs);var p=c("ge")(h),q=c("DOMQuery").scry(p,".jewelButton")[0];c("ReactDOM").render(c("React").createElement(n,{context:q,endpointConfig:l,footer:o.footerText,hideDelay:o.hideDelayInMs,hideOnBlur:o.hideOnBlur,maxImpressions:o.maxImpressions,onFooterClick:function r(){c("Toggler").show(p);c("ifRequired")("ClientChromeStore",function(s){s.dispatch({type:"UPDATE_ACTIVE_FLYOUT",data:"notification"})})},showDelay:o.showDelayInMs,title:o.titleText}),document.createElement("div"))},"NotificationUpNext")}};f.exports=i}),null);
__d("NotificationJewelListController",["NotificationComponentsBootloader","NotificationListConfig","NotificationUpNext","React","ReactDOM"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("NotificationListConfig").numNotificationsPerPage,i=c("NotificationListConfig").upNextConfig,j=null,k=null,l=null,m=false;function n(o,p){"use strict";this.$NotificationJewelListController1=false;this.$NotificationJewelListController2=false;this.$NotificationJewelListController3=o;this.$NotificationJewelListController4=p;this.$NotificationJewelListController5()}n.prototype.open=function(){"use strict";this.$NotificationJewelListController1=true;this.$NotificationJewelListController6()};n.prototype.pause=function(){"use strict";this.$NotificationJewelListController2=true;this.$NotificationJewelListController6()};n.prototype.unpause=function(){"use strict";this.$NotificationJewelListController2=false;this.$NotificationJewelListController6()};n.prototype.$NotificationJewelListController5=function(){"use strict";if(m)return;m=true;if(i)c("NotificationUpNext").initialize(i,{endpointURI:this.$NotificationJewelListController4.endpoint})};n.prototype.$NotificationJewelListController6=function(){"use strict";if(!j||!k)c("NotificationComponentsBootloader").load().done(function(o){var p=o[0],q=o[1],r=o[2];j=p;k=q;l=r;this.$NotificationJewelListController7()}.bind(this));else this.$NotificationJewelListController7()};n.prototype.$NotificationJewelListController7=function(){"use strict";if(!j||!k||!l)return;c("ReactDOM").render(c("React").createElement(l,null,c("React").createElement(j,{hasEverBeenOpened:this.$NotificationJewelListController1,paused:this.$NotificationJewelListController2,tracking:this.$NotificationJewelListController4.tracking,shortenTimestamp:this.$NotificationJewelListController4.shortenTimestamp,businessID:this.$NotificationJewelListController4.businessID,maxHeight:this.$NotificationJewelListController4.maxHeight,useChevron:this.$NotificationJewelListController4.useChevron,chevronType:this.$NotificationJewelListController4.chevronType,numPerPage:h,listRenderer:k,upsell:this.$NotificationJewelListController4.upsell||null,endpoint:this.$NotificationJewelListController4.endpoint})),this.$NotificationJewelListController3)};f.exports=n}),null);
__d("NotificationPayloadNotificationsQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLQueryBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1493379657365213"};j.getQueryID=function(){"use strict";return"894175877424772"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("XNotificationsSyncController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/notifications/sync/",{lastSync:{type:"Int",required:true}})}),null);
__d("NotificationSync",["invariant","Arbiter","AsyncRequest","ChannelConstants","CurrentUser","JSLogger","NotificationConstants","NotificationPayloadNotificationsQueryWebGraphQLQuery","NotificationsDefaultEndpointURI","NotificationStore","NotificationUpdates","WebGraphQL","WebPixelRatio","XNotificationsSyncController","gkx","idx","objectValues"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("JSLogger").create("notifications"),j="channel_reload",k=0;function l(v){var w=c("NotificationUpdates").getserverTime()?c("NotificationUpdates").getserverTime():k,x=c("XNotificationsSyncController").getURIBuilder().setInt("lastSync",w).getURI();v.setHandler(m).setOption("suppressErrorAlerts",true).setErrorHandler(n).setMethod("GET").setReadOnly(true).setURI(x).setAllowCrossPageTransition(true)}function m(v){var w=v.getPayload();if(w.syncPayload)c("NotificationUpdates").handleUpdate(c("NotificationConstants").PayloadSourceType.SYNC,w.syncPayload)}function n(v){}function o(){var v=new(c("AsyncRequest"))();v.setIsBackgroundRequest(true);l(v);v.send();i.bump(j)}function p(){var v={endpointURI:c("NotificationsDefaultEndpointURI")},w=c("objectValues")(c("NotificationStore").getAll(v)),x=w.map(function(y){return y.creation_time}).filter(Boolean);if(x.length===0)return null;return Math.max.apply(Math,x)}function q(){__p&&__p();var v=p();if(v==null)return;c("WebGraphQL").exec(new(c("NotificationPayloadNotificationsQueryWebGraphQLQuery"))({environment:"WEB_DESKTOP",is_work_user:c("CurrentUser").isWorkUser(),newer_than:v,scale:c("WebPixelRatio").get(),should_fetch_buckets:false,should_fetch_sort_keys:false,should_include_server_time:false})).done(function(w){if(w){var x,y=(x=w)!=null?(x=x.viewer)!=null?(x=x.notifications)!=null?x.edges:x:x:x,z=y&&y.map(function(B){var C=B.node;return C}).filter(Boolean);if(z==null)return;var A={nodes:z};c("NotificationUpdates").handleUpdate(c("NotificationConstants").PayloadSourceType.SYNC,A)}})}function r(){c("gkx")("AT4f1HJuuuSaLQxc87QImEVA4hInCqbUAjlpUpv42ezvKujnOWPgMzPcuQFaD7GV1PtKIWxXWvJFjkQ1z9n2EHHoQq_QcjKtZLvi2Y5juArqkQ")?q():o()}var s=null,t=0,u={setup:function v(w){__p&&__p();t++;if(k===null||w>k)k=w;if(s==null)s=c("Arbiter").subscribe(c("ChannelConstants").ON_INVALID_HISTORY,r);var x=false;return{remove:function y(){if(x===true)return;s!=null||h(0);x=true;t--;if(t===0){s.unsubscribe();s=null}}}}};f.exports=u}),null);
__d("GlobalNotificationSyncSubscription",["InitialServerTime","NotificationSync"],(function a(b,c,d,e,f,g){"use strict";f.exports=c("NotificationSync").setup(c("InitialServerTime").serverTime)}),null);
__d("JewelBadgeCountRecorder",["invariant","Arbiter","performanceNow"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=Object.create(null),j={onCountUpdated:function k(l,m){if(i[m.jewel]==null)i[m.jewel]=[];var n=i[m.jewel];n.push({timestamp:c("performanceNow")(),count:m.count});if(n.length>1e3)n.shift()},getCountAtTimestamp:function k(l,m){var n=i[l];n!=null||h(0);n.length>0||h(0);var o=n.find(function(p,q){var r=n[q+1];return q===0&&m<p.timestamp||m>p.timestamp&&(r==null||m<r.timestamp)});o||h(0);return o.count}};c("Arbiter").subscribe("jewel/count-updated",j.onCountUpdated);f.exports=j}),null);
__d("CrossWindowEventEmitter",["CacheStorage","EventEmitter","FBJSON"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("EventEmitter"));i=h&&h.prototype;function j(k){i.constructor.call(this);this.$CrossWindowEventEmitter2=k;this.$CrossWindowEventEmitter1=new(c("CacheStorage"))("localstorage",k+":");this.$CrossWindowEventEmitter1.addValueChangeCallback(function(l,m,n){var o,event=l.split(":")[1],p=c("FBJSON").parse(n),q=p.__v;(o=i.emit).call.apply(o,[this,event].concat(q))}.bind(this))}j.prototype.emit=function(k){var l;for(var m=arguments.length,n=Array(m>1?m-1:0),o=1;o<m;o++)n[o-1]=arguments[o];this.emitRemote.apply(this,[k].concat(n));(l=i.emit).call.apply(l,[this,k].concat(n))};j.prototype.emitRemote=function(k){for(var l=arguments.length,m=Array(l>1?l-1:0),n=1;n<l;n++)m[n-1]=arguments[n];this.$CrossWindowEventEmitter1.set(k,m)};f.exports=j}),null);
__d("FriendingSurfaceVisitationTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:FriendingSurfaceVisitationLoggerConfig",this.$FriendingSurfaceVisitationTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:FriendingSurfaceVisitationLoggerConfig",this.$FriendingSurfaceVisitationTypedLogger1,c("Banzai").VITAL)};h.prototype.clear=function(){this.$FriendingSurfaceVisitationTypedLogger1={};return this};h.prototype.updateData=function(j){this.$FriendingSurfaceVisitationTypedLogger1=babelHelpers["extends"]({},this.$FriendingSurfaceVisitationTypedLogger1,j);return this};h.prototype.setAppVersion=function(j){this.$FriendingSurfaceVisitationTypedLogger1.app_version=j;return this};h.prototype.setBadgeCount=function(j){this.$FriendingSurfaceVisitationTypedLogger1.badge_count=j;return this};h.prototype.setClientTimestamp=function(j){this.$FriendingSurfaceVisitationTypedLogger1.client_timestamp=j;return this};h.prototype.setRawRefTab=function(j){this.$FriendingSurfaceVisitationTypedLogger1.raw_ref_tab=j;return this};h.prototype.setRawTab=function(j){this.$FriendingSurfaceVisitationTypedLogger1.raw_tab=j;return this};h.prototype.setRefPage=function(j){this.$FriendingSurfaceVisitationTypedLogger1.ref_page=j;return this};h.prototype.setSurface=function(j){this.$FriendingSurfaceVisitationTypedLogger1.surface=j;return this};h.prototype.setTargetProfileID=function(j){this.$FriendingSurfaceVisitationTypedLogger1.target_profile_id=j;return this};h.prototype.setVC=function(j){this.$FriendingSurfaceVisitationTypedLogger1.vc=j;return this};var i={app_version:true,badge_count:true,client_timestamp:true,raw_ref_tab:true,raw_tab:true,ref_page:true,surface:true,target_profile_id:true,vc:true};f.exports=h}),null);
__d("JewelCountSideLoader",["invariant","CSS"],(function a(b,c,d,e,f,g,h){__p&&__p();var i={},j={},k={},l={queueInstances:function m(n,o,p){i[n]={badge:o,root:p}},updateCountAndQueueArgs:function m(n,o,p){__p&&__p();var q=j[n];if(q){q.updateCountAndArgs(p,o);return}var r=i[n];r||h(0);k[n]={count:o,args:p};c("CSS").conditionClass(r.root,"hasNew",!!o);r.badge.setLegacyContent(o);return},getOverwritesForJewel:function m(n){if(k[n.name])return k[n.name];j[n.name]=n;return null}};f.exports=l}),null);
__d("NotificationJewelFunnelLoggingConstants",[],(function a(b,c,d,e,f,g){"use strict";f.exports={FUNNEL_LOGGING_NAME:"WWW_NOTIFICATION_FUNNEL",FUNNEL_LOGGING_EVENT:{FETCH_NOTIFICATIONS:"fetch_notifications",OPEN_JEWEL:"open_jewel",CLOSE_JEWEL:"close_jewel",MOUSE_OVER_ON_JEWEL:"mouse_over_on_jewel",SCROLL_TO_FETCH:"scroll_to_fetch",FETCH_NEXT_SET:"fetch_next_set",CLEAR_BADGE_COUNT:"clear_badge_count"}}}),null);
__d("normalizedEventTimestamp",["performance"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){if(i!=null)if(c("performance")&&c("performance").timing&&c("performance").timing.navigationStart&&i>c("performance").timing.navigationStart)return i-=c("performance").timing.navigationStart;else return i;else if(c("performance").now)return c("performance").now();return null}f.exports=h}),null);
__d("JewelBase",["csx","invariant","Promise","Arbiter","ArbiterMixin","CrossWindowEventEmitter","CSS","DOM","Event","FriendingSurfaceVisitationTypedLogger","NotificationJewelFunnelLoggingConstants","FunnelLogger","HTML","JewelCountSideLoader","Keys","JewelLogger","Run","TabIsolation","TimeSlice","JewelBadgeCountRecorder","Toggler","TooltipData","firstClickTimestamp","killswitch","mixin","normalizedEventTimestamp","reportData"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k,l=c("NotificationJewelFunnelLoggingConstants").FUNNEL_LOGGING_EVENT,m=c("NotificationJewelFunnelLoggingConstants").FUNNEL_LOGGING_NAME,n=c("JewelLogger").logFirstJewelClick,o=new(c("CrossWindowEventEmitter"))("JewelBase"),p={};j=babelHelpers.inherits(q,c("mixin")(c("ArbiterMixin")));k=j&&j.prototype;function q(r,s){"use strict";__p&&__p();k.constructor.call(this);this.name=s.name;this.label=s.label;this.loggedFirstClick=false;this.root=r;this.badge=s.badge;this.countNew=0;this.fastTogglerShow=Boolean(s.fastTogglerShow);this.initialCount=s.count||0;this.escHandler=null;this.bootload_module=s.bootload_module;this.bootload_args=s.bootload_args;this.bootload_eager_modules=s.bootload_eager_modules;this.bootload_conf=s.bootload_conf;this.bootloading=null;this.togglerInstance=c("Toggler").getInstance(r).setSticky(false);c("JewelBadgeCountRecorder").onCountUpdated("jewel/initial-count",{jewel:this.name,count:this.initialCount});if(this.bootload_conf&&this.bootload_conf.eagerLoadingOnInteraction)this.$JewelBase3();else c("Run").onAfterLoad(function(){return this.$JewelBase4()}.bind(this));if(this.bootload_conf&&this.bootload_conf.eagerLoadingOnInteraction)this.$JewelBase5();if(s.keepOpenForSnowlift)this.togglerInstance.setPrePageTransitionCallback(this.$JewelBase6.bind(this));p[this.name]=this;this.$JewelBase7();var t=this.getFlyout();t||i(0);var u=new(c("TabIsolation"))(t);if(c("killswitch")("JEWEL_TOGGLER_INSTANCE_FIXES"))c("Toggler").createInstance(t).setSticky(false);else c("Toggler").createInstance(this.root).setFastShow(this.fastTogglerShow).setSticky(false);this.$JewelBase8();c("Toggler").listen("show",this.root,function(v){__p&&__p();c("FunnelLogger").appendAction(m,l.OPEN_JEWEL);this.inform("open");this.$JewelBase9();this.hasNew()&&this.markSeen();this.reset();c("Arbiter").inform("layer_shown",{type:"Jewel"});u.enable();this.setupEvents();this.$JewelBase10();if(this.bootload_conf&&this.bootload_conf.eagerLoadingOnInteraction)this.$JewelBase11();else this.$JewelBase4().then(function(){return this.inform("opened")}.bind(this)).done()}.bind(this));c("Toggler").listen("hide",this.root,function(v,w){c("FunnelLogger").appendAction(m,l.CLOSE_JEWEL);c("FunnelLogger").endFunnel(m);this.hasNew()&&this.markSeen();this.reset();this.inform("closed");c("Arbiter").inform("layer_hidden",{type:"Jewel"});u.disable();this.removeEvents();this.$JewelBase8()}.bind(this));c("Arbiter").subscribe("jewel/count-updated",function(v,w){w.jewel==this.name&&this.update(w)}.bind(this));c("Arbiter").subscribe("jewel/hide",function(v,w){this.hide()}.bind(this));o.addListener("count-updated",function(v){v.jewel==this.name&&this.update(v)}.bind(this))}q.prototype.getRoot=function(){"use strict";return this.root};q.prototype.hide=function(){"use strict";if(this.isOpen())c("Toggler").hide(this.root)};q.prototype.getFlyout=function(){"use strict";if(this.$JewelBase1==null)this.$JewelBase1=c("DOM").find(this.root,".__tw");return this.$JewelBase1};q.prototype.hasNew=function(){"use strict";return c("CSS").hasClass(this.root,"hasNew")};q.prototype.isOpen=function(){"use strict";return c("CSS").hasClass(this.root,"openToggler")};q.prototype.reset=function(){"use strict";c("FunnelLogger").appendAction(m,l.CLEAR_BADGE_COUNT);c("CSS").removeClass(this.root,"hasNew")};q.prototype.setContent=function(r){"use strict";var s=c("DOM").find(this.root,"ul.jewelItemList");c("DOM").setContent(s,c("HTML")(r))};q.prototype.update=function(r){"use strict";__p&&__p();if(r.animation&&this.badge.setAnimation)this.badge.setAnimation(r.animation);this.countNew=r.count;if(typeof this.countNew==="number"&&this.countNew<0)this.countNew=0;this.badge.setLegacyContent(this.countNew);var s=isNaN(this.countNew)||this.countNew>0;c("CSS").conditionClass(this.root,"hasNew",s);this.inform("updated",r,c("Arbiter").BEHAVIOR_STATE)};q.prototype.setupEvents=function(){"use strict";this.escHandler=c("Event").listen(document.documentElement,"keydown",function(r){if(r.keyCode===c("Keys").ESC)this.hide()}.bind(this))};q.prototype.removeEvents=function(){"use strict";if(this.escHandler){this.escHandler.remove();this.escHandler=null}};q.prototype.markSeen=function(){"use strict";var r=function(){c("Arbiter").inform("jewel/count-updated",{jewel:this.name,count:0},c("Arbiter").BEHAVIOR_STATE);o.emitRemote("count-updated",{jewel:this.name,count:0});this.inform("marked-seen")}.bind(this);if(this.bootload_conf&&this.bootload_conf.fixContinuation)c("TimeSlice").guard(r,"JewelOpen markSeen",{isContinuation:false})();else r()};q.prototype.getButton=function(){"use strict";if(this.$JewelBase2==null)this.$JewelBase2=c("DOM").find(this.root,"a.jewelButton");return this.$JewelBase2};q.prototype.$JewelBase8=function(){"use strict";var r=this.getButton();c("TooltipData").set(r,this.label);r.setAttribute("data-tooltip-delay","500")};q.prototype.$JewelBase10=function(){"use strict";c("TooltipData").remove(this.getButton())};q.prototype.$JewelBase6=function(r,s){"use strict";if(!this.$JewelBase12(s.from)&&!this.$JewelBase12(s.to))this.togglerInstance&&this.togglerInstance.hide()};q.prototype.$JewelBase12=function(r){"use strict";return r&&Object.prototype.hasOwnProperty.call(r.getQueryData(),"theater")};q.prototype.$JewelBase9=function(){"use strict";__p&&__p();if(!this.loggedFirstClick){this.loggedFirstClick=true;var r=this.getButton(),s=c("firstClickTimestamp").get(r);if(s){s=c("normalizedEventTimestamp")(s);if(s)n({jewelName:this.name,timestamp:s,badgeCurrentCount:c("JewelBadgeCountRecorder").getCountAtTimestamp(this.name,s),badgeInitialCount:this.initialCount})}}c("reportData")("jewel_click",{gt:{count:this.countNew,initial:this.initialCount,jewel:this.name}});if(this.name==="requests")new(c("FriendingSurfaceVisitationTypedLogger"))().setSurface("jewel").setBadgeCount(this.countNew).log()};q.prototype.$JewelBase4=function(){"use strict";if(!this.bootload_module)return c("Promise").resolve();if(!this.bootloading)this.bootloading=new(c("Promise"))(function(r,s){this.bootload_module.load().then(function(t){new t(this,this.bootload_args);r()}.bind(this))["catch"](s)}.bind(this));return this.bootloading};q.prototype.$JewelBase3=function(){"use strict";if(this.bootload_eager_modules)if(this.bootload_conf.eagerloadAfterDD)this.bootload_eager_modules.loadModules(this);else c("Run").onAfterLoad(function(){return this.bootload_eager_modules.loadModules(this)}.bind(this));else c("Run").onAfterLoad(function(){return this.$JewelBase4()}.bind(this))};q.prototype.$JewelBase5=function(){"use strict";this.bootload_eager_modules&&this.bootload_eager_modules.mount(this)};q.prototype.$JewelBase11=function(){"use strict";if(this.bootload_eager_modules)this.bootload_eager_modules.load(this);else this.$JewelBase4().then(function(){return this.inform("opened")}.bind(this)).done()};q.prototype.$JewelBase7=function(){"use strict";if(this.bootloading)return;var r=c("JewelCountSideLoader").getOverwritesForJewel(this);if(!r)return;this.updateCountAndArgs(r.args,r.count)};q.prototype.updateCountAndArgs=function(r,s){"use strict";for(var t in r)if(r[t])this.bootload_args[t]=r[t];if(s)c("Arbiter").inform("jewel/count-updated",{jewel:this.name,count:s},c("Arbiter").BEHAVIOR_STATE)};f.exports=q}),null);
__d("ModalMask",["DOM"],(function a(b,c,d,e,f,g){__p&&__p();var h=null,i=0,j={show:function k(){i++;if(!h){h=c("DOM").create("div",{id:"modalMaskOverlay"});c("DOM").appendContent(document.body,h)}},hide:function k(){if(i){i--;if(!i&&h){c("DOM").remove(h);h=null}}},getNode:function k(){return h}};f.exports=j}),null);
__d("LitestandChromeHomeBadge",["cx","Arbiter","AsyncRequest","CSS","DOM","Event","LitestandMessages","UserAgent","formatNumber"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=3e5,j={},k=void 0,l=void 0;function m(){l&&clearTimeout(l);if(k)return;l=setTimeout(n,i)}function n(){if(k||j.disableClientBadging)return;new(c("AsyncRequest"))().setURI("/ajax/litestand/newsfeed_count").setHandler(function(q){if(k)return;p.setCount(q.getPayload());m()}).setAllowCrossPageTransition(true).send()}function o(q){if(!j.badgeNode)return;var r=j.countNode===null?"_2527":"_461d";c("CSS").conditionClass(j.badgeNode,r,q>0);if(j.countNode!==null&&q>0){var s=c("formatNumber").withMaxLimit(q,j.maxCount);c("DOM").setContent(j.countNode,s)}}var p={init:function q(r){__p&&__p();j=r;c("Event").listen(j.homeNode,"click",function(event){var s=event.getModifiers(),t=s.shift,u=s.meta,v=s.control;if(t||c("UserAgent").isPlatform("Mac OS X")&&u||c("UserAgent").isPlatform("Windows")&&v)o(0)});c("Arbiter").subscribe(c("LitestandMessages").NEWSFEED_LOAD,function(){k=true;this.setCount(0)}.bind(this));c("Arbiter").subscribe(c("LitestandMessages").LEAVE_HOME,function(){k=false;m()});m()},setCount:function q(r){o(k?0:r)}};f.exports=p}),null);
__d("BootloadOnInteraction",["Event","JSResource","emptyFunction"],(function a(b,c,d,e,f,g){var h={mount:function i(j,k){var l=arguments.length<=2||arguments[2]===undefined?c("emptyFunction"):arguments[2],m=arguments.length<=3||arguments[3]===undefined?c("emptyFunction"):arguments[3],n=[c("Event").listen(j,"mouseover",o),c("Event").listen(j,"focus",o)];function o(){n.forEach(function(p){return p.remove()});m();c("JSResource").loadAll(k,l)}}};f.exports=h}),null);
__d("MercuryJewelBootloadModules",["BootloadOnInteraction","JSResource","MercuryMessengerJewelPerfConfig","JewelLogger","emptyFunction","performanceNowNoFallback","gkx"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("JewelLogger").logJsBootload,i=null,j=[c("JSResource")("MercuryJewel").__setRef("MercuryJewelBootloadModules")].concat(c("MercuryMessengerJewelPerfConfig").bundleBootloader?[c("JSResource")("MercuryOrderedThreadlist").__setRef("MercuryJewelBootloadModules"),c("JSResource")("MercuryThreadInformer").__setRef("MercuryJewelBootloadModules"),c("JSResource")("MercuryThreads").__setRef("MercuryJewelBootloadModules"),c("JSResource")("Toggler").__setRef("MercuryJewelBootloadModules")].concat(c("gkx")("AT5_2Vq7DkonMlwkytsgYLrDGVd2sxXJFDvitKn3S1lIaLXhOJ7PaaI-N2_k1bOxbVQyDWBIbJ85JSnUy78Dwfby")?[c("JSResource")("messengerGraphQLThreadlistFetcherRe").__setRef("MercuryJewelBootloadModules")]:[]):[]);function k(p,q){i=i||new p(q,q.bootload_args)}function l(p,q){k(p,q);q.inform("opened")}function m(){c("MercuryMessengerJewelPerfConfig").logJewelData&&c("performanceNowNoFallback")&&h({jewelName:"mercurymessages",eventName:"js_bootload_start",timestamp:c("performanceNowNoFallback")()})}function n(){c("MercuryMessengerJewelPerfConfig").logJewelData&&c("performanceNowNoFallback")&&h({jewelName:"mercurymessages",eventName:"js_bootload_end",timestamp:c("performanceNowNoFallback")()})}var o={mount:function p(q){var r=arguments.length<=1||arguments[1]===undefined?c("emptyFunction"):arguments[1],s=q.getButton();c("BootloadOnInteraction").mount(s,j,function(t){n();l(t,q)},function(){m();r()})},load:function p(q){m();c("JSResource").loadAll(j,function(r){n();l(r,q)})},loadModules:function p(q){m();c("JSResource").loadAll(j,function(r){n();if(c("MercuryMessengerJewelPerfConfig").eagerFlyoutOnAfterLoad)l(r,q);else k(r,q)})}};f.exports=o}),null);
__d("CSSClassTransition",[],(function a(b,c,d,e,f,g){__p&&__p();var h=[];function i(){}Object.assign(i,{go:function j(k,l,m,n){var o;for(var p=0;p<h.length;p++)if(h[p](k,l,m,n)===true)o=true;if(!o)k.className=l},registerHandler:function j(k){h.push(k);return{remove:function l(){var m=h.indexOf(k);if(m>=0)h.splice(m,1)}}}});f.exports=i}),null);
__d("QuicklingAugmenter",["URI"],(function a(b,c,d,e,f,g){__p&&__p();var h=[],i={addHandler:function j(k){h.push(k)},augmentURI:function j(k){var l=[],m=new(c("URI"))(k);h.forEach(function(n){var o=n(m);if(!o)return m;l.push(n);m=m.addQueryData(o)});h=l;return m}};f.exports=i}),null);
__d("Quickling",["ArtilleryOnUntilOffLogging","AjaxPipeRequest","Arbiter","BigPipe","ContextualComponent","CSSClassTransition","DocumentTitle","DOM","HTML","PageHooks","PageEvents","PageNavigationStageLogger","PageTransitionsRegistrar","QuicklingAugmenter","QuicklingConfig","QuicklingFetchStreamConfig","RoyalBluebar","RoyalBluebarTransitions","Run","URI","UserAgent_DEPRECATED","PHPQuerySerializer","TimerStorage","cancelAnimationFrame","cancelIdleCallback","clearImmediate","clearInterval","clearTimeout","ge","goOrReplace","isEmpty","requireWeak","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g){__p&&__p();var h,i,j;c("requireWeak")("PageTransitions",function(w){j=w});var k=c("QuicklingConfig").version,l=c("QuicklingConfig").sessionLength,m=new RegExp(c("QuicklingConfig").inactivePageRegex),n=0,o,p="",q={isActive:function w(){return true},isPageActive:function w(x){__p&&__p();if(x=="#")return false;x=new(c("URI"))(x);if(x.getDomain()&&x.getDomain()!=new(c("URI"))(window.location.href).getDomain())return false;if(x.getPath()=="/l.php"){var y=x.getQueryData().u;if(y){y=new(c("URI"))(unescape(y)).getDomain();if(y&&y!=new(c("URI"))(window.location.href).getDomain())return false}}var z=x.getPath(),A=x.getQueryData();if(!c("isEmpty")(A))z+="?"+c("PHPQuerySerializer").serialize(A);if(Object.keys(A).reduce(function(B,C){return B||c("QuicklingConfig").badRequestKeys.includes(C)},false))return false;return!m.test(z)},getLoadCount:function w(){return n}};function r(w){__p&&__p();w=w||"Facebook";c("DocumentTitle").set(w);if(c("UserAgent_DEPRECATED").ie()){p=w;if(!o)o=window.setInterval(function(){var x=p,y=c("DocumentTitle").get();if(x!=y)c("DocumentTitle").set(x)},5e3,false)}}h=babelHelpers.inherits(s,c("AjaxPipeRequest"));i=h&&h.prototype;function s(w){"use strict";var x={version:k};i.constructor.call(this,w,{quickling:x});this._isQuickling=true}s.prototype._preBootloadFirstResponse=function(w){"use strict";return true};s.prototype._fireDomContentCallback=function(){"use strict";this._request.cavalry&&this._request.cavalry.setTimeStamp("t_domcontent");if(j)j.transitionComplete();this._onPageDisplayed&&this._onPageDisplayed(this.pipe);i._fireDomContentCallback.call(this)};s.prototype._fireOnloadCallback=function(){"use strict";if(this._request.cavalry){this._request.cavalry.setTimeStamp("t_hooks");this._request.cavalry.setTimeStamp("t_layout");this._request.cavalry.setTimeStamp("t_onload")}i._fireOnloadCallback.call(this)};s.prototype.isPageActive=function(w){"use strict";return q.isPageActive(w)};s.prototype._versionCheck=function(w){"use strict";if(w.version==k)return true;var x=["quickling","ajaxpipe","ajaxpipe_token"];c("PageNavigationStageLogger").setCookieForNavigation(w.uri);c("PageNavigationStageLogger").setNote("quickling_version");c("PageNavigationStageLogger").updateCookie();c("goOrReplace")(window.location,new(c("URI"))(w.uri).removeQueryData(x),true);return false};s.prototype._processFirstResponse=function(w){"use strict";var x=w.getPayload();r(x.title);window.scrollTo(0,0);c("CSSClassTransition").go(document.body,x.body_class||"",j.getMostRecentURI(),w.getRequest().getURI());c("Arbiter").inform("quickling/response");c("ArtilleryOnUntilOffLogging").onNewPageLoad()};s.prototype.getSanitizedParameters=function(){"use strict";return["quickling"]};s.prototype._getAsyncRequestType=function(){"use strict";if(c("QuicklingFetchStreamConfig").experimentName!==c("RoyalBluebarTransitions").OFF)return"useFetchWithIframeFallback";return"useIframeTransport"};function t(){n++;return n>=l}function u(w){__p&&__p();c("AjaxPipeRequest").setCurrentRequest(null);if(t()){c("PageNavigationStageLogger").setNote("quickling_refresh");return false}w=c("QuicklingAugmenter").augmentURI(w);if(!q.isPageActive(w)){c("PageNavigationStageLogger").setNote("quickling_inactive");return false}c("TimerStorage").clearAll(c("TimerStorage").ANIMATION_FRAME,c("cancelAnimationFrame"));c("TimerStorage").clearAll(c("TimerStorage").IDLE_CALLBACK,c("cancelIdleCallback"));c("TimerStorage").clearAll(c("TimerStorage").IMMEDIATE,c("clearImmediate"));c("TimerStorage").clearAll(c("TimerStorage").INTERVAL,c("clearInterval"));c("TimerStorage").clearAll(c("TimerStorage").TIMEOUT,c("clearTimeout"));window.ExitTime=Date.now();c("Run").__removeHook(c("PageHooks").ONLOAD_HOOK);c("Run").__removeHook(c("PageHooks").DOMREADY_HOOK);c("Arbiter").inform(c("PageEvents").AJAXPIPE_ONUNLOAD,{transition_type:"quickling"});var x="content";v(x);c("RoyalBluebar").startTransitionAnimation();var y=new s(w).setCanvasId(x).setResetHandler(c("RoyalBluebar").stopTransitionAnimation).setFinallyHandler(c("RoyalBluebar").stopTransitionAnimation).send();y.getArbiter().subscribeOnce(c("BigPipe").Events.displayed,c("RoyalBluebar").stopTransitionAnimation);var z=window.__bodyWrapper;if(z.getCodeUsage)z.clearCodeUsage();return c("PageTransitionsRegistrar").DELAY_HISTORY}function v(w){var x=function x(){var y=c("ge")(w),z=c("ContextualComponent").forNode(y);if(z)z.cleanup();c("PageHooks").runHooks("onleavehooks")};if(c("QuicklingConfig").useAsyncLeaveHooks)c("setTimeoutAcrossTransitions")(x,0);else x()}c("Run").onAfterLoad(function w(){c("PageTransitionsRegistrar").registerHandler(u,1)});f.exports=b.Quickling=q}),null);
__d("ViewasChromeBar",["csx","cx","Arbiter","AsyncRequest","CSS","DOM","Event","Focus","ModalMask","PageTransitionsRegistrar","Parent"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j="ViewasChromeBar/initialized",k=null,l=false;function m(p){c("Arbiter").subscribe(j,p)}function n(p){c("CSS").addClass(p,"_7g7");var q=c("DOM").find(p,"._7g0");c("Focus").set(c("DOM").find(q,".textInput"))}var o={initChromeBar:function p(q){if(l)return;k=q;l=true;c("Arbiter").inform(j,null,c("Arbiter").BEHAVIOR_STATE)},update:function p(q,r){m(function(){c("DOM").setContent(k,q);if(r)new(c("AsyncRequest"))("/ajax/privacy/glasgow/viewas_bar_flyout_open").send()})},registerSpecificModeOnClick:function p(q){c("Event").listen(q,"click",function(){var r=c("Parent").bySelector(q,"._7f-");if(r instanceof HTMLElement)n(r)})},registerFlyoutModalMask:function p(){c("ModalMask").show();c("PageTransitionsRegistrar").registerHandler(c("ModalMask").hide,10)}};f.exports=o}),null);