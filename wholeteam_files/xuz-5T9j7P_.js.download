if (self.CavalryLogger) { CavalryLogger.start_js(["maels"]); }

__d("FBRTCDismissReason",[],(function a(b,c,d,e,f,g){f.exports={CALL_ENDED:0,ANSWERED_ON_ANOTHER_DEVICE:1,IN_ANOTHER_CALL:2,CONNECTION_DROPPED:3,REJECTED_ON_ANOTHER_DEVICE:4,REMOVED_BY_PARTICIPANT:5,REJECTED_BY_CALLEE:6,INTERNAL_ERROR:7,JOIN_APPROVAL_DENIED:8}}),null);
__d("FBRTCHangupReason",[],(function a(b,c,d,e,f,g){f.exports={IGNORE_CALL:0,HANGUP_CALL:1,NO_ANSWER_TIMEOUT:2,CLIENT_ERROR:3,IN_ANOTHER_CALL:4,CLIENT_INTERRUPTED:5}}),null);
__d("FBRTCRtcResponseStatusCode",[],(function a(b,c,d,e,f,g){f.exports={OK:200,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,METHOD_NOT_ALLOWED:406,CONDITIONAL_REQUEST_FAILED:412,BUSY_HERE:486,SERVER_INTERNAL_ERROR:500,SERVICE_UNAVAILABLE:503,PRECONDITION_FAILURE:580}}),null);
__d("CollabRTCChromeScreenSharingExtension",["invariant","Promise","idx"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i="CHROME_WEBSTORE_UNDEFINED",j="DIALOG_USER_CANCEL",k="EXTENSION_NOT_FOUND",l="REQUEST_ID_UNDEFINED",m="UNEXPECTED_ERROR",n="degmgkchmbgaognjjlhggmhbcpicdifm",o="data-fb-screensharing-extension-available";function p(){this.CHROME_WEBSTORE_UNDEFINED=i;this.DIALOG_USER_CANCEL=j;this.EXTENSION_NOT_FOUND=k;this.EXTENSION_PRESENCE_ATTR=o;this.REQUEST_ID_UNDEFINED=l;this.UNEXPECTED_ERROR=m}p.prototype.isInstalled=function(){var v=document,w=v.documentElement;return w!=null&&w.hasAttribute(o)&&w.getAttribute(o)==="true"};p.prototype.install=function(){__p&&__p();var v;q(this.getExtensionURL());var w=(v=window)!=null?(v=v.chrome)!=null?v.webstore:v:v;if(w==null)return c("Promise").reject(new Error(i));return new(c("Promise"))(function(x,y){w.install(this.getExtensionURL(),function(){var z=document,A=z.documentElement;if(A!=null)A.setAttribute(o,"true");x()},function(z,A){return y(new Error(A))})}.bind(this)).then(function(){return this.$CollabRTCChromeScreenSharingExtension2(5)}.bind(this))};p.prototype.getSourceID=function(){__p&&__p();var v=arguments.length<=0||arguments[0]===undefined?false:arguments[0];if(!this.isInstalled()){if(v)return c("Promise").reject(new Error(k));return this.install().then(function(){return this.getSourceID(true)}.bind(this))}return s().then(function(w){switch(w.type){case"streamID":this.$CollabRTCChromeScreenSharingExtension1=w.requestID;return w.streamID;case"canceledGetStreamID":throw new Error(j);default:throw new Error(m)}}.bind(this))};p.prototype.getExtensionID=function(){return n};p.prototype.getExtensionURL=function(){return"https://chrome.google.com/webstore/detail/"+n};p.prototype.stop=function(){return t(this.$CollabRTCChromeScreenSharingExtension1).then(function(){this.$CollabRTCChromeScreenSharingExtension1=null}.bind(this))};p.prototype.$CollabRTCChromeScreenSharingExtension2=function(v){return u({type:"ping"})["catch"](function(w){if(v<1)throw w;return r(100).then(function(){return this.$CollabRTCChromeScreenSharingExtension2(v-1)}.bind(this))}.bind(this))};function q(v){var w="chrome-webstore-item";if(!document.querySelector('link[href="'+v+'"][rel="'+w+'"]')){var x=document.createElement("link");x.setAttribute("href",v);x.setAttribute("rel",w);document.head!=null||h(0);document.head.appendChild(x)}}function r(v){return new(c("Promise"))(function(w){return setTimeout(w,v)})}function s(){return u({type:"getStreamID",sources:["screen","window","tab"]})}function t(v){if(v==null)return c("Promise").reject(new Error(l));return u({type:"cancel",requestID:v})}function u(v){return new(c("Promise"))(function(w,x){window.chrome.runtime.sendMessage(n,v,function(y){if(y!=null)w(y);else{var z=window.chrome.runtime.lastError.message;x(new Error(z))}})})}f.exports=new p()}),null);
__d("CollabRTCChromeScreenSharing",["CollabRTCChromeScreenSharingExtension"],(function a(b,c,d,e,f,g){"use strict";var h={getSourceID:function i(){return c("CollabRTCChromeScreenSharingExtension").getSourceID()},stop:function i(){return c("CollabRTCChromeScreenSharingExtension").stop()}};f.exports=h}),null);
__d("RTCEndCallReason",["fbt","FBRTCConstants","FBRTCDismissReason","FBRTCHangupReason","FBRTCRtcResponseStatusCode"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("FBRTCConstants").CallEndReason,j=c("FBRTCConstants").CollabCallEndSubreason;function k(l){this.$RTCEndCallReason1=-1;this.$RTCEndCallReason3="local";this.$RTCEndCallReason4=false;if(typeof l==="string"||l instanceof String)this.$RTCEndCallReason1=i.strNames.indexOf(l);else this.$RTCEndCallReason1=l}k.prototype.setSubreason=function(l){this.$RTCEndCallReason2=l;return this};k.prototype.getSubreason=function(){return this.$RTCEndCallReason2};k.prototype.setRemoteEnded=function(l){this.$RTCEndCallReason3=l?"remote":"local";return this};k.prototype.toStrName=function(){var l=arguments.length<=0||arguments[0]===undefined?true:arguments[0];return l?this.$RTCEndCallReason5()+"_"+this.$RTCEndCallReason3:this.$RTCEndCallReason5()};k.prototype.$RTCEndCallReason5=function(){if(this.$RTCEndCallReason1<0||this.$RTCEndCallReason1>i.strNames.length)return"Unknown";return i.strNames[this.$RTCEndCallReason1]};k.prototype.getReasonID=function(){return this.$RTCEndCallReason1};k.prototype.toString=function(){var l=arguments.length<=0||arguments[0]===undefined?false:arguments[0],m=(this.$RTCEndCallReason6()||"").toString();return l?m+" "+this.$RTCEndCallReason7():m};k.prototype.$RTCEndCallReason6=function(){__p&&__p();switch(this.$RTCEndCallReason1){case i.NO_ANSWER_TIMEOUT:case i.IGNORE_CALL:return h._("No Answer");case i.OTHER_NOT_CAPABLE:if(this.$RTCEndCallReason2===j.MCU_INVALID_STREAM_CONFIGURATION)return h._("Too many clients connected to the room");case i.INCOMING_TIMEOUT:case i.NO_PERMISSION:case i.OTHER_CARRIER_BLOCKED:return h._("Not Reachable");case i.SIGNALING_MESSAGE_FAILED:case i.WEBRTC_ERROR:case i.NO_UI_ERROR:case i.CALLER_NOT_VISIBLE:case i.CLIENT_ERROR:return h._("Call Failed");case i.UNSUPPORTED_VERSION:return h._("Can't Connect Call");case i.IN_ANOTHER_CALL:return h._("In Another Call");case i.CARRIER_BLOCKED:return h._("Switch to Wi-Fi to complete your call");case i.CLIENT_INTERRUPTED:return h._("Call Interrupted");case i.HANGUP_CALL:case i.ACCEPT_AFTER_HANGUP:return h._("Call Ended");case i.CONNECTION_DROPPED:return h._("Connection Lost");case i.OTHER_INSTANCE_HANDLED:return null;default:return null}};k.prototype.$RTCEndCallReason7=function(){__p&&__p();if(this.$RTCEndCallReason1!==i.OTHER_NOT_CAPABLE&&this.$RTCEndCallReason1!==i.SIGNALING_MESSAGE_FAILED)return"";switch(this.$RTCEndCallReason2){case j.REMOTE_PEER_HANGUP:case j.REMOTE_PEER_REJECT:return"";case j.CLOSED_BY_MCU:return"- Call expired";case j.CLOSED_AS_STALE:return"- Server failed, call is stale";case j.CALL_INITIALIZATION_FAILED:return"- Call initialization to room failed";case j.SIP_CONNECTION_INITIALIZATION_FAILED:return"or No Answer";case j.LOST_MCU_CONNECTION:return"- MCU Media connection failed";case j.LOST_MCU_THRIFT_CONNECTION:return"- MCU infrastructure dropped connection";case j.LOST_SIP_ADAPTER_CONNECTION:return"- SIP infrastructure dropped connection";case j.MCU_NO_AUDIO_STREAM:return"- Invalid audio stream";case j.MCU_INVALID_STREAM_CONFIGURATION:return"- Invalid stream configuration";case j.UNKNOWN:default:return"- Unexpected call failure: "+(this.$RTCEndCallReason2||"null")}};k.fromHangupReason=function(l){switch(l){case c("FBRTCHangupReason").IGNORE_CALL:return new k(i.IGNORE_CALL);case c("FBRTCHangupReason").NO_ANSWER_TIMEOUT:return new k(i.NO_ANSWER_TIMEOUT);case c("FBRTCHangupReason").HANGUP_CALL:return new k(i.HANGUP_CALL);case c("FBRTCHangupReason").CLIENT_ERROR:return new k(i.CLIENT_ERROR);case c("FBRTCHangupReason").IN_ANOTHER_CALL:return new k(i.IN_ANOTHER_CALL);case c("FBRTCHangupReason").CLIENT_INTERRUPTED:return new k(i.CLIENT_INTERRUPTED);default:return new k(i.HANGUP_CALL)}};k.fromDismissRequest=function(l){__p&&__p();if(!l)return new k(i.HANGUP_CALL);switch(l.reason){case c("FBRTCDismissReason").ANSWERED_ON_ANOTHER_DEVICE:case c("FBRTCDismissReason").REJECTED_ON_ANOTHER_DEVICE:return new k(i.OTHER_INSTANCE_HANDLED);case c("FBRTCDismissReason").CALL_ENDED:return new k(i.HANGUP_CALL);case c("FBRTCDismissReason").IN_ANOTHER_CALL:return new k(i.IN_ANOTHER_CALL);case c("FBRTCDismissReason").CONNECTION_DROPPED:return new k(i.CONNECTION_DROPPED);case c("FBRTCDismissReason").REMOVED_BY_PARTICIPANT:return new k(i.HANGUP_CALL);case c("FBRTCDismissReason").REJECTED_BY_CALLEE:return new k(i.IGNORE_CALL);case c("FBRTCDismissReason").INTERNAL_ERROR:return new k(i.SIGNALING_MESSAGE_FAILED);default:return new k(i.HANGUP_CALL)}};k.fromResponseStatusCode=function(l){switch(l){case c("FBRTCRtcResponseStatusCode").PRECONDITION_FAILURE:case c("FBRTCRtcResponseStatusCode").METHOD_NOT_ALLOWED:case c("FBRTCRtcResponseStatusCode").UNAUTHORIZED:return new k(i.NO_PERMISSION);case c("FBRTCRtcResponseStatusCode").SERVICE_UNAVAILABLE:return new k(i.SIGNALING_MESSAGE_FAILED);case c("FBRTCRtcResponseStatusCode").SERVER_INTERNAL_ERROR:case c("FBRTCRtcResponseStatusCode").BAD_REQUEST:case c("FBRTCRtcResponseStatusCode").BUSY_HERE:case c("FBRTCRtcResponseStatusCode").CONDITIONAL_REQUEST_FAILED:case c("FBRTCRtcResponseStatusCode").NOT_FOUND:return new k(i.CLIENT_ERROR);default:return new k(i.HANGUP_CALL)}};f.exports=k}),null);
__d("RTCUserMediaConstraints",["FBRTCConstants","RTCConfig"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("FBRTCConstants").VideoQuality,i={width:1920,height:1080,frameRate:30},j={width:1280,height:720,frameRate:30},k={width:854,height:480,frameRate:30},l={width:320,height:180,frameRate:15},m={audio:function t(u){return u?{deviceId:u}:true},video:function t(u,v){var w=arguments.length<=2||arguments[2]===undefined?c("RTCConfig").CollaborationCallQuality.videoToRoom:arguments[2];if(u===h.NO_VIDEO)return false;var x=v?{deviceId:v}:null;if(u===h.CUSTOM_VIDEO)return babelHelpers["extends"]({},w,x);var y=n(u);return babelHelpers["extends"]({width:o(y,"width"),height:o(y,"height"),frameRate:o(y,"frameRate",{frameRate:10})},x)},chromeMediaSource:function t(u,v){var w=u.video,x=m.chromify(w);if(typeof x!=="object")return{audio:false,video:Boolean(x)};var y=x.mandatory,z=x.optional,A=z===undefined?[]:z;return{audio:false,video:{mandatory:babelHelpers["extends"]({},y,{chromeMediaSource:"desktop",chromeMediaSourceId:v}),optional:[{googTemporalLayeredScreencast:true}].concat(A)}}},chromify:function t(u){__p&&__p();if(!u||typeof u!=="object")return Boolean(u);if(!s(u))return u;var v=u.mandatory,w=v===undefined?{}:v,x=u.optional,y=x===undefined?[]:x;for(var z=Object.entries(u),A=Array.isArray(z),B=0,z=A?z:z[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var C;if(A){if(B>=z.length)break;C=z[B++]}else{B=z.next();if(B.done)break;C=B.value}var D=C,E=D[0],F=D[1];if(E==="require"||E==="advanced"||E==="mediaSource")continue;var G=F&&typeof F==="object"?F:{ideal:F};if(Number.isFinite(G.exact)){G.min=G.exact;G.max=G.exact}var H=G.ideal,I=G.exact;if(H!==undefined)if(Number.isFinite(H)){var J,K;y.push((J={},J[r(E,"min")]=H,J),(K={},K[r(E,"max")]=H,K))}else{var L;y.push((L={},L[r(E)]=H,L))}if(I!==undefined&&!Number.isFinite(I))w[r(E)]=I;else{var M=["min","max"];for(var N=0;N<M.length;N++){var O=M[N];if(Number.isFinite(G[O]))w[r(E,O)]=G[O]}}}if(u.advanced)y.push.apply(y,u.advanced);var P={};if(Object.keys(w).length>0)P.mandatory=w;if(y.length>0)P.optional=y;return P}};function n(t){switch(t){case h.FHD_VIDEO:return i;case h.HD_VIDEO:return j;case h.LQ_VIDEO:return l;case h.SD_VIDEO:return k;default:return j}}function o(t,u){var v=arguments.length<=2||arguments[2]===undefined?p(t):arguments[2],w=t[u];return{min:Math.min(v[u],w),max:Math.max(q(t)[u],w),ideal:w}}function p(t){switch(t){case i:return j;case j:return k;case k:case l:default:return l}}function q(t){switch(t){case l:return k;case k:return j;case j:case i:default:return i}}function r(t,r){if(r)return""+r+t.charAt(0).toUpperCase()+t.slice(1);return t==="deviceId"?"sourceId":t}function s(t){return Object.keys(t).some(function(u){return u!=="mandatory"&&u!=="optional"})}f.exports=m}),null);
__d("MediaStream",[],(function a(b,c,d,e,f,g){f.exports=window.MediaStream||window.webkitMediaStream}),null);
__d("RTCAudioTrackNoiseDetector",["invariant","Promise","MediaStream"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i="audio track with absolute silence",j="audio track data timeout",k='wrong track type, expected "audio"',l=100,m={ABSOLUTE_SILENCE_ERROR:i,DATA_TIMEOUT_ERROR:j,WRONG_TRACK_TYPE_ERROR:k,detect:function n(o,p){__p&&__p();if("kind"in o&&o.kind!=="audio")return c("Promise").reject(new Error(k));var q=new(c("MediaStream"))();q.addTrack(o);var r=new AudioContext(),s=r.createMediaStreamSource(q),t=r.createScriptProcessor(0,1,1),u=l,v=function v(){__p&&__p();t!=null||h(0);t.onaudioprocess=null;t.disconnect();t=null;s!=null||h(0);s.disconnect();s=null;q!=null||h(0);q.removeTrack(o);q=null;r!=null||h(0);return c("Promise").resolve(r.close())["catch"](function(){return c("Promise").resolve()}).then(function(){r=null})};return c("Promise").race([new(c("Promise"))(function(w,x){__p&&__p();t!=null||h(0);t.onaudioprocess=function(y){__p&&__p();var z=y.inputBuffer;for(var A=z.getChannelData(0),B=Array.isArray(A),C=0,A=B?A:A[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var D;if(B){if(C>=A.length)break;D=A[C++]}else{C=A.next();if(C.done)break;D=C.value}var E=D;if(E!==0){w();return}}if(u>0)u--;else x(new Error(i))};s!=null||h(0);s.connect(t);r!=null||h(0);t.connect(r.destination)}),new(c("Promise"))(function(w){return setTimeout(w,p)}).then(function(){throw new Error(j)})]).then(function(){return v()})["catch"](function(w){return v().then(function(){throw w})})}};f.exports=m}),null);
__d("RTCVideoTrackActivityDetector",["invariant","Promise","MediaStream"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=window.URL||window.webkitURL,j=HTMLMediaElement&&"srcObject"in HTMLMediaElement.prototype,k="video track playback timeout",l="unexpected video track ready state",m='wrong track type, expected "video"',n={PLAYBACK_TIMEOUT_ERROR:k,WRONG_READY_STATE_ERROR:l,WRONG_TRACK_TYPE_ERROR:m,detect:function o(p,q){__p&&__p();if("kind"in p&&p.kind!=="video")return c("Promise").reject(new Error(m));var r=document.createElement("video");r.muted=true;var s=new(c("MediaStream"))();s.addTrack(p);var t=void 0,u=0,v=function v(){__p&&__p();clearInterval(u);if(r){r.pause();if(j)r.srcObject=null;else if(r.src){i.revokeObjectURL(r.src);r.src=""}r.removeEventListener("timeupdate",t);r=null}if(s){s.removeTrack(p);s=null}};return c("Promise").race([new(c("Promise"))(function(w,x){__p&&__p();r!=null||h(0);if(j)r.srcObject=s;else r.src=i.createObjectURL(s);t=function t(y){r!=null||h(0);if(r.currentTime>0)if(p.readyState==="live"){w();v()}else x(new Error(l))};c("Promise").resolve(r.pause()).then(function(){r!=null||h(0);return r.play()}).then(function(){t();r!=null||h(0);r.addEventListener("timeupdate",t);u=setInterval(t,50)})["catch"](function(y){return x(y)})}),new(c("Promise"))(function(w){return setTimeout(w,q)}).then(function(){throw new Error(k)})])["catch"](function(w){v();throw w})}};f.exports=n}),null);
__d("RTCMediaStreamValidator",["Promise","RTCAudioTrackNoiseDetector","RTCVideoTrackActivityDetector"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="no audio tracks",i="no video tracks",j="too many audio tracks",k="too many video tracks",l="unexpected audio track(s)",m="unexpected video track(s)",n={NO_AUDIO_TRACKS_ERROR:h,NO_VIDEO_TRACKS_ERROR:i,TOO_MANY_AUDIO_TRACKS_ERROR:j,TOO_MANY_VIDEO_TRACKS_ERROR:k,UNEXPECTED_AUDIO_TRACKS_ERROR:l,UNEXPECTED_VIDEO_TRACKS_ERROR:m,validate:function q(r,s){var t=arguments.length<=2||arguments[2]===undefined?{}:arguments[2],u=arguments.length<=3||arguments[3]===undefined?{}:arguments[3],v=t.audio,w=v===undefined?true:v,x=t.video,y=x===undefined?true:x,z=u.audio,A=z===undefined?1e3:z,B=u.video,C=B===undefined?1e3:B;return c("Promise").all([o(r,s,w,A),p(r,s,y,C)]).then(function(){return r})}};function o(q,r,s,t){var u=q.getAudioTracks();if(!r.audio)return u.length>0?c("Promise").reject(new Error(l)):c("Promise").resolve(q);if(u.length<1)return c("Promise").reject(new Error(h));else if(u.length>1)return c("Promise").reject(new Error(j));return!s?c("Promise").resolve(q):c("RTCAudioTrackNoiseDetector").detect(u[0],t).then(function(){return q})}function p(q,r,s,t){var u=q.getVideoTracks();if(!r.video)return u.length>0?c("Promise").reject(new Error(m)):c("Promise").resolve(q);if(u.length<1)return c("Promise").reject(new Error(i));else if(u.length>1)return c("Promise").reject(new Error(k));return!s?c("Promise").resolve(q):c("RTCVideoTrackActivityDetector").detect(u[0],t).then(function(){return q})}f.exports=n}),null);
__d("RTCUtils",["invariant","Promise","CurrentUser","FBRTCConstants","FBRTCUtils","RTCAudioTrackNoiseDetector","RTCConfig","RTCEndCallReason","RTCMediaStreamValidator","RTCScreenSharing","RTCUser","RTCUserMediaConstraints","RTCVideoTrackActivityDetector","URI","UserAgent","randomInt"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("FBRTCConstants").VideoQuality,j=c("RTCAudioTrackNoiseDetector").DATA_TIMEOUT_ERROR,k=c("RTCVideoTrackActivityDetector").PLAYBACK_TIMEOUT_ERROR,l={generateRandomInt:function o(){return c("randomInt")(0,4294967294)+1},isGroupCall:function o(p){return p.split(":")[0]==="GROUP"},isMessengerCall:function o(p){return p.split(":")[0]==="MESSENGER"},isPartiesCall:function o(p){return p.split(":")[0]==="BONFIRE"},getPeerID:function o(p){if(this.isGroupCall(p))throw new Error("Not a P2P call: "+p);var q=p.split(":"),r=q.slice(1);return r[0]===c("CurrentUser").getID()?r[1]:r[0]},createRequestHeader:function o(p,q,r){var s={type:p,transactionId:l.generateRandomInt().toString(),retryCount:0,conferenceName:q};if(r)s.serverInfoData=r;return s},createResponseHeader:function o(p,q){var r={type:p.type,transactionId:p.transactionId,retryCount:0,conferenceName:p.conferenceName,responseStatusCode:q};if(p.serverInfoData)r.serverInfoData=p.serverInfoData;return r},getUserMedia:function o(p){__p&&__p();var q=navigator,r=q.mediaDevices;if(typeof p.video==="object"&&p.video.mediaSource)return c("RTCScreenSharing").getUserMedia(p);var s=this._parseConstraints(p);return new(c("Promise"))(function(t,u){__p&&__p();if(r&&typeof r.getUserMedia==="function")t(r.getUserMedia(s));else if(navigator.getUserMedia)navigator.getUserMedia(s,t,u);else if(navigator.webkitGetUserMedia)navigator.webkitGetUserMedia(s,t,u);else if(navigator.mozGetUserMedia)navigator.mozGetUserMedia(s,t,u);else if(navigator.msGetUserMedia)navigator.msGetUserMedia(s,t,u);else u("getUserMedia not supported")})["catch"](function(t){throw m(t)})},_parseConstraints:function o(p){if(c("UserAgent").isBrowser("Chrome")||c("UserAgent").isBrowser("Opera")){var q=p.audio,r=p.video,s={};if(q!=undefined)s.audio=c("RTCUserMediaConstraints").chromify(q);if(r!=undefined)s.video=c("RTCUserMediaConstraints").chromify(r);return s}return p},getUserMediaWithValidation:function o(p){__p&&__p();var q=arguments.length<=1||arguments[1]===undefined?{audio:true,video:true}:arguments[1],r=arguments.length<=2||arguments[2]===undefined?5:arguments[2],s=arguments.length<=3||arguments[3]===undefined?{audio:1e3,video:1e3}:arguments[3];return new(c("Promise"))(function(t,u){__p&&__p();var v=function(w){__p&&__p();this.getUserMedia(p).then(function(x){return c("RTCMediaStreamValidator").validate(x,p,q,s).then(function(x){return t({stream:x})})["catch"](function(y){if(y.message===j||y.message===k)t({stream:x,err:y});else{this.stopMediaStream(x);throw y}}.bind(this))}.bind(this),u)["catch"](function(x){if(w>0)v(w-1);else u(x)})}.bind(this);v(r)}.bind(this))},initLocalStream:function o(p){return l.getUserMedia({audio:c("RTCUserMediaConstraints").audio(),video:c("RTCUserMediaConstraints").video(p?i.HD_VIDEO:i.NO_VIDEO)})},initLocalScreenStream:function o(){var p=arguments.length<=0||arguments[0]===undefined?"screen":arguments[0];return l.getUserMedia({audio:false,video:babelHelpers["extends"]({},c("RTCConfig").CollaborationCallQuality.screen_v2||c("RTCConfig").CollaborationCallQuality.screen,{mediaSource:p})})},isFullScreen:function o(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},requestFullScreen:function o(){var p=arguments.length<=0||arguments[0]===undefined?document.documentElement:arguments[0];if(typeof p.requestFullscreen==="function")p.requestFullscreen();else if(typeof p.msRequestFullscreen==="function")p.msRequestFullscreen();else if(typeof p.mozRequestFullScreen==="function")p.mozRequestFullScreen();else if(typeof p.webkitRequestFullscreen==="function")p.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},exitFullScreen:function o(){if(typeof document.exitFullscreen==="function")document.exitFullscreen();else if(typeof document.msExitFullscreen==="function")document.msExitFullscreen();else if(typeof document.mozCancelFullScreen==="function")document.mozCancelFullScreen();else if(typeof document.webkitExitFullscreen==="function")document.webkitExitFullscreen()},toggleFullScreen:function o(){if(this.isFullScreen())this.exitFullScreen();else this.requestFullScreen()},endCallReasonFromHangupReason:function o(p){return c("RTCEndCallReason").fromHangupReason(p).getReasonID()},endCallReasonFromDismissRequest:function o(p){return c("RTCEndCallReason").fromDismissRequest(p).getReasonID()},endCallReasonFromResponseStatusCode:function o(p){return c("RTCEndCallReason").fromResponseStatusCode(p).getReasonID()},stopMediaStream:function o(p){__p&&__p();if(!p.active&&"active"in p)return;for(var q=p.getTracks(),r=Array.isArray(q),s=0,q=r?q:q[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var t;if(r){if(s>=q.length)break;t=q[s++]}else{s=q.next();if(s.done)break;t=s.value}var u=t;if(u.readyState!=="ended")u.stop()}},payloadParticipantsToRTCUsers:function o(p){return p.map(function(q){var r=q.big_image_src||q.image_src;q.fbid||h(0);return new(c("RTCUser"))({FBID:q.fbid,profileUrl:new(c("URI"))(q.href),profilePictureUrl:r,isMessengerUser:!!q.is_messenger_user,isPartiesUser:!!q.is_parties_user,userName:q.name,userShortName:q.short_name,vanity:q.vanity||""})})},getStreamVideoResolution:function o(p){__p&&__p();return new(c("Promise"))(function(q,r){__p&&__p();var s=document.createElement("video");c("FBRTCUtils").attachMediaStream(s,p);var t=function t(){s.removeEventListener("loadedmetadata",u);s.removeEventListener("error",v);c("FBRTCUtils").attachMediaStream(s,null)},u=function u(){q({height:s.videoHeight,width:s.videoWidth});t()},v=function v(){r(s.error);t()};s.addEventListener("loadedmetadata",u);s.addEventListener("error",v)})}};function m(o){var p=o.message,q=o.name;return Object.assign(new Error(p==="The operation is insecure."?"The request is not allowed by the user agent or the platform in the current context.":p),{name:n(q)})}function n(o){switch(o){case"ConstraintNotSatisfiedError":return"OverconstrainedError";case"DevicesNotFoundError":return"NotFoundError";case"InvalidStateError":case"MediaDeviceFailedDueToShutdown":case"MediaDeviceKillSwitchOn":case"TrackStartError":return"NotReadableError";case"PermissionDeniedError":return"NotAllowedError";default:return o}}f.exports=l}),null);
__d("WorkplaceChatHelper",[],(function a(b,c,d,e,f,g){"use strict";var h={isWorkplaceChatDesktop:function i(){return window.workchat!=null},getScreenSharingSourceID:function i(){return window.workchat.getScreenSharingSourceID()},stopScreenSharing:function i(){return window.workchat.stopScreenSharing()}};f.exports=h}),null);
__d("RTCScreenSharing",["Promise","CollabRTCChromeScreenSharing","RTCUserMediaConstraints","RTCUtils","UserAgent","WorkplaceChatHelper"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="SCREEN_SHARING_NOT_SUPPORTED",i="UNEXPECTED_ERROR",j={SCREEN_SHARING_NOT_SUPPORTED:h,getUserMedia:function k(l){__p&&__p();if(c("UserAgent").isBrowser("Firefox")&&navigator.mediaDevices)return c("Promise").resolve(navigator.mediaDevices.getUserMedia(l)["catch"](function(m){if(m.name==="NotAllowedError")throw new Error(h)}));if(c("UserAgent").isBrowser("Chrome"))return(c("WorkplaceChatHelper").isWorkplaceChatDesktop()?c("WorkplaceChatHelper").getScreenSharingSourceID():c("CollabRTCChromeScreenSharing").getSourceID()).then(function(m){return c("RTCUtils").getUserMedia(c("RTCUserMediaConstraints").chromeMediaSource(l,m))}).then(function(m){__p&&__p();for(var n=m.getTracks(),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var q;if(o){if(p>=n.length)break;q=n[p++]}else{p=n.next();if(p.done)break;q=p.value}var r=q;r.addEventListener("ended",function(s){return setTimeout(function(){if(!m.active)j.stop()})})}return m});return c("Promise").reject(new Error(h))},stop:function k(){if(c("UserAgent").isBrowser("Chrome"))return c("WorkplaceChatHelper").isWorkplaceChatDesktop()?c("WorkplaceChatHelper").stopScreenSharing():c("CollabRTCChromeScreenSharing").stop();return c("Promise").reject(new Error(i))}};f.exports=j}),null);