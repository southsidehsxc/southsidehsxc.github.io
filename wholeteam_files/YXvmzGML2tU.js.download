if (self.CavalryLogger) { CavalryLogger.start_js(["OiVZh"]); }

__d("EventPlanTimeHelper",["DateConsts","EventReminderConstants"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("EventReminderConstants").TimeErrorType,i={getTimeErrorType:function j(k){var l=new Date(k),m=new Date(),n=new Date(new Date().setFullYear(new Date().getFullYear()+1));if(l<=m)return h.PAST_TIME;else if(l>=n)return h.AFTER_ONE_YEAR;else return h.NO_ERROR},getDefaultDateTime:function j(k){if(k)return k*c("DateConsts").MS_PER_SEC;var l=new Date();l.setHours(l.getHours()+1);l.setMinutes(0);return l.getTime()}};f.exports=i}),null);
__d("LightweightEventDateTimePicker.react",["ix","cx","fbt","invariant","DatePickerRestraints","EventPlanTimeHelper","EventReminderConstants","Image.react","React","XUICalendar.react","XUIDateTimePicker.react","emptyFunction","fbglyph"],(function a(b,c,d,e,f,g,h,i,j,k){"use strict";__p&&__p();var l,m,n=c("EventReminderConstants").TimeErrorType;l=babelHelpers.inherits(o,c("React").Component);m=l&&l.prototype;function o(p){m.constructor.call(this,p);this.$LightweightEventDateTimePicker1=function(q){var r=q.getTime(),s=c("EventPlanTimeHelper").getTimeErrorType(r);this.setState({dateTime:r,showTimeError:s});this.props.onDateTimeChange(r,s)}.bind(this);this.state={dateTime:this.props.initialDateTime,showTimeError:n.NO_ERROR}}o.prototype.render=function(){__p&&__p();var p=c("XUICalendar.react").normalizeDate(new Date()),q=[c("DatePickerRestraints").enforceDateIsNoEarlierThan(p)],r=void 0;switch(this.state.showTimeError){case n.PAST_TIME:r=j._("Event time must be in the future.");break;case n.AFTER_ONE_YEAR:r=j._("Select a date within one year from today.");break;case n.NO_ERROR:r=null;break;default:k(0)}return c("React").createElement("div",{className:"_lny"},c("React").createElement(c("XUIDateTimePicker.react"),{date:new Date(this.state.dateTime),dateIcon:c("React").createElement(c("Image.react"),{src:h("125721")}),dateRestraints:q,onChange:this.$LightweightEventDateTimePicker1,xuiError:r}),c("React").createElement("span",{className:"_lo4","aria-label":j._("Clock icon")}))};o.defaultProps={onDateTimeChange:c("emptyFunction")};f.exports=o}),null);
__d("LightweightEventLocationTypeahead.react",["cx","fbt","AddressTypeahead.react","AddressTypeaheadCaller","AddressTypeaheadDisplayOrder","AddressTypeaheadIntegration","AddressTypeaheadProvider","AddressTypeaheadSearchSourceConfig","AddressTypeaheadType","React","XUIContextualDialog.react","XUITypeaheadView.react","emptyFunction"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k,l=3,m="lightweight_events_creation";j=babelHelpers.inherits(n,c("React").Component);k=j&&j.prototype;function n(o){"use strict";__p&&__p();k.constructor.call(this,o);this.$LightweightEventLocationTypeahead5=function(p){var q=this.$LightweightEventLocationTypeahead2(p),r=this.$LightweightEventLocationTypeahead3(p),s=this.$LightweightEventLocationTypeahead4(p);this.setState({queryString:r});this.props.onLocationSelect(q,r,s)}.bind(this);this.$LightweightEventLocationTypeahead6=function(event){var p="";if(event.target instanceof HTMLInputElement)p=event.target.value;this.setState({queryString:p});this.props.onLocationChange(p)}.bind(this);this.state={queryString:this.props.initialQueryString}}n.prototype.$LightweightEventLocationTypeahead2=function(o){"use strict";var p=o.getAuxiliaryData();if(p&&p.resultType&&p.resultType==="place")return p.locationID;return""};n.prototype.$LightweightEventLocationTypeahead3=function(o){"use strict";var p=o.getAuxiliaryData();if(p)if(p.freeformEntry)return p.selectedTitle;else if(p.resultType==="street")return o.getSubtitle();return o.getTitle()};n.prototype.$LightweightEventLocationTypeahead4=function(o){"use strict";var p=o.getAuxiliaryData();return p?p.full_address:""};n.prototype.$LightweightEventLocationTypeahead7=function(){"use strict";return new(c("AddressTypeaheadSearchSourceConfig"))(null,null,c("AddressTypeaheadProvider").HERE_THRIFT,c("AddressTypeaheadType").STREET_PLACE_TYPEAHEAD,c("AddressTypeaheadIntegration").STRING_MATCH,c("AddressTypeaheadDisplayOrder").INTERLEAVE,l,c("AddressTypeaheadCaller").LIGHTWEIGHT_EVENTS_CREATION)};n.prototype.focusInput=function(){"use strict";this.$LightweightEventLocationTypeahead1&&this.$LightweightEventLocationTypeahead1.focusInput()};n.prototype.componentDidMount=function(){"use strict";this.focusInput()};n.prototype.render=function(){"use strict";var o={};if(this.props.useDropDown==false)o={layerComponent:c("XUIContextualDialog.react"),layerPosition:"left",useDialog:true};return c("React").createElement(c("AddressTypeahead.react"),babelHelpers["extends"]({},this.props,{className:"_1t92",config:this.$LightweightEventLocationTypeahead7(),isFreeFormQueryAllowed:true,queryString:this.state.queryString,onSelectAttempt:this.$LightweightEventLocationTypeahead5,onChange:this.$LightweightEventLocationTypeahead6,placeholder:i._("Choose a Location"),productTag:m,ref:function(p){return this.$LightweightEventLocationTypeahead1=p}.bind(this),layerComponent:this.props.layerComponent,layerPosition:this.props.layerPosition,useDialog:true,viewRenderer:this.props.viewRenderer}))};n.defaultProps={initialQueryString:"",layerComponent:c("XUIContextualDialog.react"),layerPosition:"left",onLocationChange:c("emptyFunction"),onLocationSelect:c("emptyFunction"),useDropDown:false,viewRenderer:c("XUITypeaheadView.react")};f.exports=n}),null);
__d("LightweightEventLocationRow.react",["cx","LightweightEventLocationTypeahead.react","React","ReactDOM","ShimButton.react","emptyFunction"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=262;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(m){j.constructor.call(this,m);this.$LightweightEventLocationRow1=function(){if(this.props.disabled)return;this.setState({showTypeahead:true})}.bind(this);this.$LightweightEventLocationRow2=function(n,o,p){this.setState({locationName:o,locationAddress:p,showTypeahead:false});this.props.onLocationSelect(n,o,p)}.bind(this);this.state={locationName:this.props.initialLocationName,locationAddress:this.props.initialLocationAddress,showTypeahead:!this.props.initialLocationName}}l.prototype.render=function(){var m=this.state,n=m.locationName,o=m.locationAddress,p=m.showTypeahead,q=this.props,r=q.onLocationChange,s=q.useDropDown;if(!p)return c("React").createElement(c("ShimButton.react"),{className:"_16yp",onClick:this.$LightweightEventLocationRow1},c("React").createElement("div",null,c("React").createElement("div",{className:"_16yq"},n),c("React").createElement("div",{className:"_16yr"},o)));var t="left",u=c("ReactDOM").findDOMNode(this.refs.typeahead);if(u&&u instanceof Element&&u.getBoundingClientRect().left<k)t="right";return c("React").createElement(c("LightweightEventLocationTypeahead.react"),{initialQueryString:n,layerPosition:t,onLocationChange:r,onLocationSelect:this.$LightweightEventLocationRow2,useDropDown:s,ref:"typeahead"})};l.defaultProps={disabled:false,initialLocationName:"",initialLocationAddress:"",onLocationChange:c("emptyFunction"),onLocationSelect:c("emptyFunction"),useDropDown:false};f.exports=l}),null);
__d("ChangeChatTabColorDialog",["ix","cssVar","cx","fbt","Grid.react","Image.react","MercuryThreads","MessagingThreadCustomizationConfig","messengerCustomThreadColorButtonReact","MessagingThreadCustomizationSource","React","SimpleXUIDialog","MercuryThreadActions","XUIDialogCancelButton.react","convertMIGColorToFIGColor","fbglyph"],(function a(b,c,d,e,f,g,h,i,j,k){"use strict";__p&&__p();var l=c("Grid.react").GridItem,m=c("MercuryThreads").get(),n=c("messengerCustomThreadColorButtonReact").jsComponent,o=c("MercuryThreadActions").get(),p="Unknown Color",q={show:function s(t,u){var v=m.getThreadMetaNow(t),w=v&&v.custom_color?v.custom_color:"#0084ff",x=355,y=null,z=["#0084ff"].concat(c("MessagingThreadCustomizationConfig").colorChoices),A=c("MessagingThreadCustomizationConfig").colorNames,B=z.map(function(F){return c("React").createElement(l,{key:F,className:"_gs0"},c("React").createElement("div",null,F.toLowerCase()==w.toLowerCase()?c("React").createElement(c("Image.react"),{className:"_gs2",src:h("114570")}):null,c("React").createElement(n,{colorChoice:c("convertMIGColorToFIGColor")(F)||F,colorName:A[F]||p,isSelected:F===w,onChoose:function G(){r(y,t,F,w)}})))}),C=k._("Pick a color for this conversation"),D=c("React").createElement("div",{className:"_gs3 _430z"},c("React").createElement("div",{className:"_28he"},k._("Everyone in this conversation will see this.")),c("React").createElement(c("Grid.react"),{cols:5,className:"_gs4"},B)),E=c("React").createElement("div",null,c("React").createElement(c("XUIDialogCancelButton.react"),null));y=c("SimpleXUIDialog").showEx(D,C,E,null,{width:x,causalElement:u})}};function r(s,t,u,v){if(u!=v){o.changeThreadColor(t,u,c("MessagingThreadCustomizationSource").SETTINGS);if(s)s.hide()}}f.exports=q}),null);
__d("LightweightEventType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({EVENT:"EVENT",CALL:"CALL",DIRECT_M:"DIRECT_M"})}),null);
__d("XCreateEventReminderController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/ajax/eventreminder/create/",{acontext:{type:"String",required:true},event_type:{type:"Enum",required:true,enumType:1},event_time:{type:"Int"},thread_id:{type:"Int",required:true},title:{type:"String"},location_id:{type:"String"},location_name:{type:"String"},related_event_id:{type:"Int"}})}),null);
__d("ChatStartPlanDialogHelper",["cx","fbt","AsyncRequest","DateConsts","EventPlanTimeHelper","EventReminderConstants","EventRemindersGating","EventsActionsLogger","FBJSON","LightweightEventDateTimePicker.react","LightweightEventLocationRow.react","LightweightEventType","MercuryIDs","React","SimpleXUIDialog","DialogX","XCreateEventReminderController","XUIButton.react","XUITextInput.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("EventReminderConstants").TimeErrorType;"use strict";function k(){__p&&__p();this.$ChatStartPlanDialogHelper9=function(l,m){this.$ChatStartPlanDialogHelper1=l;this.$ChatStartPlanDialogHelper6=m}.bind(this);this.$ChatStartPlanDialogHelper11=function(l){this.$ChatStartPlanDialogHelper3="";this.$ChatStartPlanDialogHelper4=l;this.$ChatStartPlanDialogHelper5=""}.bind(this);this.$ChatStartPlanDialogHelper12=function(l,m,n){this.$ChatStartPlanDialogHelper3=l;this.$ChatStartPlanDialogHelper4=m;this.$ChatStartPlanDialogHelper5=n}.bind(this)}k.prototype.showDialog=function(l){this.$ChatStartPlanDialogHelper7();var m=null,n=this.$ChatStartPlanDialogHelper8(),o=c("React").createElement("div",null,c("React").createElement(c("LightweightEventDateTimePicker.react"),{initialDateTime:this.$ChatStartPlanDialogHelper1,onDateTimeChange:this.$ChatStartPlanDialogHelper9}),c("React").createElement("hr",null),c("React").createElement(c("XUITextInput.react"),{className:"_2l1n","aria-label":i._("Event Name"),placeholder:i._("Name"),onChange:function(event){return this.$ChatStartPlanDialogHelper10(event)}.bind(this)}),c("React").createElement("hr",null),c("React").createElement(c("LightweightEventLocationRow.react"),{onLocationChange:this.$ChatStartPlanDialogHelper11,onLocationSelect:this.$ChatStartPlanDialogHelper12,useDropDown:true})),p=c("React").createElement(c("XUIButton.react"),{label:this.$ChatStartPlanDialogHelper13(),use:"confirm",onClick:function(){return this.$ChatStartPlanDialogHelper14(m,l)}.bind(this)});m=c("SimpleXUIDialog").showEx(o,n,p,null)};k.prototype.$ChatStartPlanDialogHelper7=function(){this.$ChatStartPlanDialogHelper1=c("EventPlanTimeHelper").getDefaultDateTime();this.$ChatStartPlanDialogHelper2="";this.$ChatStartPlanDialogHelper3="";this.$ChatStartPlanDialogHelper4="";this.$ChatStartPlanDialogHelper5="";this.$ChatStartPlanDialogHelper6=j.NO_ERROR};k.prototype.$ChatStartPlanDialogHelper10=function(event){this.$ChatStartPlanDialogHelper2=event.target.value};k.prototype.$ChatStartPlanDialogHelper14=function(l,m){if(this.$ChatStartPlanDialogHelper6!==j.NO_ERROR)return;var n=c("MercuryIDs").getThreadFBIDFromThreadID(m),o={action_history:[{surface:c("EventsActionsLogger").Surface.MESSENGER_CHAT_TAB,mechanism:c("EventsActionsLogger").Mechanism.MESSENGER_THREAD_SETTINGS}]},p=c("XCreateEventReminderController").getURIBuilder().setString("acontext",c("FBJSON").stringify(o)).setEnum("event_type",c("LightweightEventType").EVENT).setInt("event_time",Math.floor(this.$ChatStartPlanDialogHelper1/c("DateConsts").MS_PER_SEC)).setInt("thread_id",n).setString("title",this.$ChatStartPlanDialogHelper2).setString("location_id",this.$ChatStartPlanDialogHelper3).setString("location_name",this.$ChatStartPlanDialogHelper4);new(c("AsyncRequest"))(p.getURI()).setHandler(function(q){if(q.payload&&l)l.hide()}).send()};k.prototype.$ChatStartPlanDialogHelper8=function(){return c("EventRemindersGating").shouldUseNewName?i._("Plan"):i._("Event Reminder")};k.prototype.$ChatStartPlanDialogHelper13=function(){return c("EventRemindersGating").shouldUseNewName?i._("Start Plan"):i._("Create")};f.exports=new k()}),null);
__d("EditChatTabNicknameDialog",["cx","fbt","MercuryIDs","MessengerDialogHeader.react","MessengerTextWithEmojiInput.react","MessagingThreadCustomizationConfig","MessagingThreadCustomizationSource","MessengerDialogCancelButton.react","MessengerDialogButton.react","MessengerDialogFooter.react","MercuryThreadActions","React","SimpleXUIDialog"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("MercuryThreadActions").get(),k=400,l={show:function m(n,o,p,q,r){var s=null,t=c("MercuryIDs").getUserIDFromParticipantID(o.id),u=t===q?i._("Edit Your Nickname"):i._("Edit Nickname for {personName}",[i.param("personName",o.name)]),v=c("React").createElement("div",{className:"_2c1u"},c("React").createElement(c("MessengerDialogHeader.react"),null,u)),w=c("React").createElement("div",{className:"_2c1u"},c("React").createElement("div",{className:"_21g-"},c("React").createElement("div",{className:"_-bo"},i._("Everyone in this conversation will see this.")),c("React").createElement(c("MessengerTextWithEmojiInput.react"),{className:"_2c1v",initialValue:p,onReturn:function(){return this._handleSave(s,n,o,p)}.bind(this),maxLength:c("MessagingThreadCustomizationConfig").maxNicknameLength,placeholder:o.name}))),x=c("React").createElement("div",{className:"_2c1u"},c("React").createElement(c("MessengerDialogFooter.react"),null,c("React").createElement(c("MessengerDialogCancelButton.react"),null),c("React").createElement(c("MessengerDialogButton.react"),{label:i._("Save"),onClick:function(){return this._handleSave(s,n,o,p)}.bind(this),type:"primary"})));s=c("SimpleXUIDialog").showEx(w,v,x,null,{NICKNAME_DIALOG_WIDTH:k,causalElement:r})},_handleSave:function m(n,o,p,q){if(!n)return;var r=n._reactContainer.querySelector("[data-text]").textContent;if(r!==q)j.changeThreadNicknames(o,c("MercuryIDs").getUserIDFromParticipantID(p.id),r,c("MessagingThreadCustomizationSource").SETTINGS);n.hide()}};f.exports=l}),null);
__d("EditChatTabNicknamesDialog",["cx","fbt","EditChatTabNicknameDialog","immutable","ImmutableObject","MercuryThreads","MercuryIDs","MessengerAdminGroupUtils","MercuryParticipants","MessengerContactList.react","MessengerDialogHeader.react","MessengerDialogTitle.react","MessengerScrollableArea.react","React","SimpleXUIDialog","XUIDialogCancelButton.react","idx"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("MercuryThreads").get(),k=200,l=350,m={show:function n(o,p,q){__p&&__p();var r=null,s=j.getThreadMetaNow(o),t=c("immutable").Map().withMutations(function(z){if(!s)return;s.participants&&s.participants.forEach(function(A){z.set(A,c("MercuryParticipants").getOrFetch(A))});s.is_subscribed&&z.set(c("MercuryIDs").getParticipantIDFromUserID(p),c("MercuryParticipants").getOrFetch(c("MercuryIDs").getParticipantIDFromUserID(p)))}),u=c("MessengerAdminGroupUtils").isJoinableThread(s),v=t.filter(function(z){if(!z)return false;var A=c("MercuryIDs").getUserIDFromParticipantID(z.id);return u&&A===p||!u}).toArray(),w=c("React").createElement("div",{className:"_4h9n"},c("React").createElement(c("MessengerDialogHeader.react"),null,c("React").createElement(c("MessengerDialogTitle.react"),null,i._("Edit Nicknames")))),x=c("React").createElement("div",{className:"_4h9n"},c("React").createElement("div",{className:"_4h9o"},c("React").createElement(c("MessengerScrollableArea.react"),{height:"100%"},c("React").createElement(c("MessengerContactList.react"),{contactAdapter:function(z){return this._fromMercuryParticipant(z,s)}.bind(this),disableRole:true,listSections:c("immutable").OrderedMap([[null,v]]),onSelect:function(z){r&&r.hide();setTimeout(function(){return this._handleContactSelect(z,s,p)}.bind(this),k)}.bind(this),rowClassName:"_44kr",viewer:p,thread:s})))),y=c("React").createElement("div",null,c("React").createElement(c("XUIDialogCancelButton.react"),null));r=c("SimpleXUIDialog").showEx(x,w,y,null,{NICKNAME_DIALOG_WIDTH:l,causalElement:q})},_handleContactSelect:function n(o,p,q){var r,s=c("MercuryIDs").getUserIDFromParticipantID(o.id),t=((r=p)!=null?(r=r.custom_nickname)!=null?r[s]:r:r)||"",u=p.thread_id;c("EditChatTabNicknameDialog").show(u,o,t,q,this.linkRef)},_fromMercuryParticipant:function n(o,p){var q=c("MercuryIDs").getUserIDFromParticipantID(o.id),r=o.name,s="";if(p.custom_nickname&&p.custom_nickname[q]){r=p.custom_nickname[q];s=o.name}return new(c("ImmutableObject"))({alias:o.alias,uid:o.id,photo:o.image_src,title:r,subtitle:s,type:o.type,isMessengerUser:o.is_messenger_user,href:o.href})}};f.exports=m}),null);
__d("WebMessengerDeleteThreadDialog",["fbt","React","SimpleXUIDialog","MercuryThreadActions","XUIDialogButton.react","XUIDialogCancelButton.react"],(function a(b,c,d,e,f,g,h){"use strict";var i=c("MercuryThreadActions").get(),j={show:function k(l,m,n,o){var p=h._("Delete This Entire Conversation?"),q=h._("Once you delete your copy of this conversation, it cannot be undone."),r=c("React").createElement("div",null,c("React").createElement(c("XUIDialogCancelButton.react"),null),c("React").createElement(c("XUIDialogButton.react"),{action:"cancel",label:h._("Delete Conversation"),use:"confirm",onClick:function s(){i["delete"](l);m&&m()}}));c("SimpleXUIDialog").showEx(q,p,r,n,{causalElement:o})}};f.exports=j}),null);
__d("MNCommerceReviewDialogTextArea.react",["cx","AbstractTextArea.react","React","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;k.prototype.render=function(){var l=c("joinClasses")(this.props.className,"_3g_j");return c("React").createElement(c("AbstractTextArea.react"),babelHelpers["extends"]({},this.props,{className:l}))};function k(){i.apply(this,arguments)}f.exports=k}),null);
__d("MNCommerceReviewDialog.react",["fbt","cx","MessengerEnvironment","MNCommerceButton.react","MNCommerceDetailsDialog.react","MNCommerceDialogBody.react","MNCommerceDialogFooter.react","MNCommerceDialogTitle.react","React","StarsInput.react","MNCommerceReviewDialogTextArea.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes;j=babelHelpers.inherits(m,c("React").Component);k=j&&j.prototype;function m(o,p){k.constructor.call(this,o,p);n.call(this);this.state=this.$MNCommerceReviewDialog1()}m.prototype.componentWillReceiveProps=function(o){this.setState(this.$MNCommerceReviewDialog1(o))};m.prototype.render=function(){var o=this.props.merchantName||"",p=this.state.rating>0,q=this.props.review||"",r=this.state.review||"",s=this.state.rating!==this.props.rating||r.length!==q.length||r!==q,t=h._("Write a review for {label for merchant name}",[h.param("label for merchant name",o)]),u=h._("Cancel"),v=h._("Send"),w=h._("Reivew options couldn't be shown.");return c("React").createElement(c("MNCommerceDetailsDialog.react"),babelHelpers["extends"]({errorMessage:w,onToggle:this.props.onToggle,shown:this.props.shown},this.props),c("React").createElement(c("MNCommerceDialogTitle.react"),{showCloseButton:true},t),c("React").createElement(c("MNCommerceDialogBody.react"),null,this.$MNCommerceReviewDialog2()),c("React").createElement(c("MNCommerceDialogFooter.react"),null,c("React").createElement(c("MNCommerceButton.react"),{label:u,onClick:this.props.onCancelButtonClick,use:"default"}),c("React").createElement(c("MNCommerceButton.react"),{label:v,onClick:this.$MNCommerceReviewDialog3,disabled:!p||!s,use:"confirm"})))};m.prototype.$MNCommerceReviewDialog2=function(){var o=c("MessengerEnvironment").messengerui,p=this.state.rating||0,q=this.state.review||"",r=(o?"_159y":"")+(!o?" _159z":""),s=(o?"_15a3":"")+" _15a4";return c("React").createElement("div",null,c("React").createElement("div",{className:s}," Rate your experience"),c("React").createElement(c("StarsInput.react"),{allowMultipleSubmissions:true,large:true,onClick:this.onStarsChangeClick,count:p}),c("React").createElement(c("MNCommerceReviewDialogTextArea.react"),{className:r,defaultValue:q,onChange:this.onReviewChange,placeholder:"Write a review..."}))};m.propTypes={error:l.object,loading:l.bool.isRequired,rating:l.number,review:l.string,merchantName:l.string,onCancelButtonClick:l.func,onConfirmButtonClick:l.func.isRequired,pageId:l.string};var n=function n(){__p&&__p();this.onStarsChangeClick=function(o){var p=this.state.review;this.onTypeChange(o,p)}.bind(this);this.onReviewChange=function(o){var p=this.state.rating;this.onTypeChange(p,o.target.value)}.bind(this);this.$MNCommerceReviewDialog1=function(o){var p=o||this.props,q=p.rating,r=p.review;return{rating:q,review:r}}.bind(this);this.onTypeChange=function(o,p){this.setState({rating:o,review:p})}.bind(this);this.$MNCommerceReviewDialog3=function(o){var p=this.props;p.onToggle(false);if(!p.onConfirmButtonClick)return;var q=p.pageId;p.onConfirmButtonClick(q,this.state.rating,this.state.review)}.bind(this)};f.exports=m}),null);
__d("MessengerPlatformBotReviewActions",["MessengerDispatcher","MNCommerceActionTypes"],(function a(b,c,d,e,f,g){"use strict";var h={stateLoaded:function i(j){c("MessengerDispatcher").dispatch({type:c("MNCommerceActionTypes").BOT_REVIEW_STATE.LOADED,state:j})},stateLoadError:function i(j){c("MessengerDispatcher").dispatch({type:c("MNCommerceActionTypes").BOT_REVIEW_STATE.LOAD_ERROR,pageID:j})},stateReload:function i(j){c("MessengerDispatcher").dispatch({type:c("MNCommerceActionTypes").BOT_REVIEW_STATE.RELOAD,pageID:j})}};f.exports=h}),null);
__d("XMessengerPlatformBotReviewReadController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messages/platform/bot_review/read/",{page_id:{type:"FBID",required:true}})}),null);
__d("MessengerPlatformBotReviewReadDataManager",["AsyncRequest","MessengerPlatformBotReviewActions","XMessengerPlatformBotReviewReadController"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();h.prototype.fetchReviewState=function(i){var j=c("XMessengerPlatformBotReviewReadController").getURIBuilder().setFBID("page_id",i).getURI();new(c("AsyncRequest"))().setURI(j).setHandler(this.$MessengerPlatformBotReviewReadDataManager1).setErrorHandler(this.$MessengerPlatformBotReviewReadDataManager2).send()};h.prototype.$MessengerPlatformBotReviewReadDataManager1=function(i){var j=i.getRequest().uri.getQueryData(),k=j.page_id;if(i)i.payload.pageID=k;c("MessengerPlatformBotReviewActions").stateLoaded(i.payload)};h.prototype.$MessengerPlatformBotReviewReadDataManager2=function(i){var j=i.getRequest().uri.getQueryData(),k=j.page_id;c("MessengerPlatformBotReviewActions").stateLoadError(k)};function h(){}f.exports=new h()}),null);
__d("MessengerPlatformBotReviewStore",["Cache","FluxStore","LoadObject","MessengerDispatcher","MessengerPlatformBotReviewReadDataManager","MNCommerceActionTypes","MNCommerceCacheTimeoutLimits"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("FluxStore"));i=h&&h.prototype;function j(){i.constructor.call(this,c("MessengerDispatcher"));this.$MessengerPlatformBotReviewStore1=new(c("Cache"))()}j.prototype.__onDispatch=function(k){__p&&__p();var l=k.type,m=k.pageID||k.state&&k.state.pageID;switch(l){case c("MNCommerceActionTypes").BOT_REVIEW_STATE.LOADED:var n=k.state;this.$MessengerPlatformBotReviewStore1.set(m,c("LoadObject").empty().setValue(n),null,c("MNCommerceCacheTimeoutLimits").SUCCESS_TIMEOUT);this.__emitChange();break;case c("MNCommerceActionTypes").BOT_REVIEW_STATE.LOAD_ERROR:this.$MessengerPlatformBotReviewStore1.set(m,c("LoadObject").empty().setError(new Error("Unable to load permissions for: "+m)),null,c("MNCommerceCacheTimeoutLimits").ERROR_TIMEOUT);this.__emitChange();break;case c("MNCommerceActionTypes").BOT_REVIEW_STATE.RELOAD:if(m){this.$MessengerPlatformBotReviewStore1.set(m,c("LoadObject").loading());c("MessengerPlatformBotReviewReadDataManager").fetchReviewState(m)}this.__emitChange();break}};j.prototype.getReviewState=function(k){if(k&&!this.$MessengerPlatformBotReviewStore1.has(k)){this.$MessengerPlatformBotReviewStore1.set(k,c("LoadObject").loading().setValue({pageID:k}));c("MessengerPlatformBotReviewReadDataManager").fetchReviewState(k)}return this.$MessengerPlatformBotReviewStore1.get(k)||c("LoadObject").empty()};f.exports=new j()}),null);
__d("MNCommerceReviewDialogContainer.react",["MessengerPlatformBotReviewStore","MNCommerceDialogStateActions","MNCommerceDialogStateStore","MNCommerceReviewDialog.react","PureStoreBasedStateMixin","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("React").createClass({displayName:"MNCommerceReviewDialogContainer",mixins:[c("PureStoreBasedStateMixin")(c("MessengerPlatformBotReviewStore"))],statics:{calculateState:function i(){var j=c("MNCommerceDialogStateStore").getState(),k=null;if(j)k=j.pageID;var l=c("MessengerPlatformBotReviewStore").getReviewState(k);return{shown:!!j,loading:l.isLoading(),onConfirmButtonClick:j&&j.onConfirmButtonClick,pageID:k,reviewState:l.getValue(),error:l.getError()}}},render:function i(){var j=this.state.reviewState;return c("React").createElement(c("MNCommerceReviewDialog.react"),{error:this.state.error,loading:this.state.loading,shown:this.state.shown,rating:j.rating,review:j.review,merchantName:j&&j.name,onCancelButtonClick:this._hideDialog,onConfirmButtonClick:this.state.onConfirmButtonClick,onToggle:this._onToggle,pageId:this.state.pageID})},_onToggle:function i(j){if(!j)this._hideDialog()},_hideDialog:function i(){c("MNCommerceDialogStateActions").hideDialog()}});f.exports=h}),null);
__d("MercuryThreadMuter",["AsyncDialog","AsyncRequest","DOM","MercuryThreadInfo"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={showMuteChangeDialog:function i(j,k){__p&&__p();c("AsyncDialog").send(new(c("AsyncRequest"))("/ajax/mercury/mute_thread_dialog.php").setRelativeTo(k),function(l){l.subscribe("confirm",function(){this.hide();var m=void 0;c("DOM").scry(this.getRoot(),'input[type="radio"]').forEach(function(n){if(n.checked)m=n.value});m=h.convertRawMuteSetting(m);e(["MercuryThreadActions"],function(n){n.get().updateMuteSetting(j,m)})}.bind(l))})},convertRawMuteSetting:function i(j){switch(j){case"always":return-1;case"30minutes":return 1800;case"1hour":return 3600;case"8hours":return 8*3600;case"24hours":return 24*3600;default:return 0}}};f.exports=h}),null);
__d("MNCommerceBotsReviewResponseDialog.react",["fbt","MessengerEnvironment","MNCommerceAttachmentConstants","XUIDialog.react","XUIDialogBody.react","XUIDialogTitle.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;k.prototype.render=function(){var l=c("MessengerEnvironment").messengerui?c("MNCommerceAttachmentConstants").MDOTCOMDIALOG.WIDTH:c("MNCommerceAttachmentConstants").DIALOG.WIDTH,m=this.props.success?h._("Thanks for your review!"):h._("Something went wrong"),n=this.props.success?h._("Your review has been successfully submitted."):h._("Please try again");return c("React").createElement(c("XUIDialog.react"),babelHelpers["extends"]({autohide:2e3,width:l},this.props),c("React").createElement(c("XUIDialogTitle.react"),null,m),c("React").createElement(c("XUIDialogBody.react"),null,c("React").createElement("div",null,n)))};function k(){i.apply(this,arguments)}f.exports=k}),null);
__d("MNCommerceBotsReviewConfirmationDialogContainer.react",["MNCommerceBotsReviewResponseDialog.react","MNCommerceDialogStateActions","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;function j(){var k,l;for(var m=arguments.length,n=Array(m),o=0;o<m;o++)n[o]=arguments[o];return l=(k=i.constructor).call.apply(k,[this].concat(n)),this.$MNCommerceBotsReviewConfirmationDialogContainer1=function(p){if(!p)this.$MNCommerceBotsReviewConfirmationDialogContainer2()}.bind(this),this.$MNCommerceBotsReviewConfirmationDialogContainer2=function(){c("MNCommerceDialogStateActions").hideDialog()},l}j.prototype.render=function(){return c("React").createElement(c("MNCommerceBotsReviewResponseDialog.react"),{success:true,shown:true,onToggle:this.$MNCommerceBotsReviewConfirmationDialogContainer1})};f.exports=j}),null);
__d("MNCommerceBotsReviewErrorDialogContainer.react",["MNCommerceBotsReviewResponseDialog.react","MNCommerceDialogStateActions","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;function j(){var k,l;for(var m=arguments.length,n=Array(m),o=0;o<m;o++)n[o]=arguments[o];return l=(k=i.constructor).call.apply(k,[this].concat(n)),this.$MNCommerceBotsReviewErrorDialogContainer1=function(p){if(!p)this.$MNCommerceBotsReviewErrorDialogContainer2()}.bind(this),this.$MNCommerceBotsReviewErrorDialogContainer2=function(){c("MNCommerceDialogStateActions").hideDialog()},l}j.prototype.render=function(){return c("React").createElement(c("MNCommerceBotsReviewResponseDialog.react"),{success:false,shown:true,onToggle:this.$MNCommerceBotsReviewErrorDialogContainer1})};f.exports=j}),null);
__d("XMessengerPlatformBotReviewWriteController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messages/platform/bot_review/write/",{page_id:{type:"FBID",required:true},rating:{type:"Int",required:true},review:{type:"String"}})}),null);
__d("MessengerPlatformBotReviewWriteDataManager",["AsyncRequest","MessengerPlatformBotReviewActions","XMessengerPlatformBotReviewWriteController","MNCommerceBotsReviewErrorDialogContainer.react","MNCommerceBotsReviewConfirmationDialogContainer.react","MNCommerceDialogStateActions"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();h.prototype.review=function(i,j,k){var l=c("XMessengerPlatformBotReviewWriteController").getURIBuilder().setFBID("page_id",i).setInt("rating",j).setString("review",k).getURI();new(c("AsyncRequest"))().setURI(l).setHandler(this.$MessengerPlatformBotReviewWriteDataManager1).setErrorHandler(this.$MessengerPlatformBotReviewWriteDataManager2).send()};h.prototype.$MessengerPlatformBotReviewWriteDataManager1=function(i){var j=i.getRequest().uri.getQueryData(),k=j.page_id;c("MessengerPlatformBotReviewActions").stateReload(k);c("MNCommerceDialogStateActions").showDialog(c("MNCommerceBotsReviewConfirmationDialogContainer.react"),{})};h.prototype.$MessengerPlatformBotReviewWriteDataManager2=function(i){var j=i.getRequest().uri.getQueryData(),k=j.page_id;c("MessengerPlatformBotReviewActions").stateLoadError(k);c("MNCommerceDialogStateActions").showDialog(c("MNCommerceBotsReviewErrorDialogContainer.react"),{})};function h(){}f.exports=new h()}),null);
__d("XMessagingGroupOptionsDialogController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/dialog/group_options/",{thread_fbid:{type:"String",required:true},__asyncDialog:{type:"Int"}})}),null);
__d("ChatTabMenu.react",["cx","fbt","AsyncDialog","AsyncRequest","AutoFocusableLink.react","ChatConfig","ChatPrivacyActionController","CurrentUser","Dialog","EventReminderStateStore","EventRemindersGating","FantaMessageActions","FantaTabActions","GroupsActionURIConstants","JSResource","BootloadedComponent.react","MercuryConfig","MercuryIDs","MercuryLogMessageType","MercuryParticipants","MercurySourceType","MercuryThreadMuter","MercuryViewer","MessengerAdminGroupUtils","MessengerMessageRequestsTypedLogger","MessengerPlatformBotReviewWriteDataManager","MessagingTag","MNCommerceDialogStateActions","MNCommercePromotionBlockDataManager","MNCommercePromotionManageBlockDialogContainer.react","MNCommerceReviewDialogContainer.react","NFXChatHeadGK","PopoverMenu.react","ReactComponentWithPureRenderMixin","React","ReactDOM","ReactMenu","MercuryMessageObject","MercuryThreadActions","MercuryThreadIDMap","MercuryThreads","MercuryMessageActions","ChangeChatTabColorDialog","EditChatTabNicknamesDialog","MenuSeparator.react","ShimButton.react","Toggler","TrackingNodes","URI","WebMessengerDeleteThreadDialog","WebMessengerThreadPermalinks","XNFXStartForMessageThreadController","WorkModeConfig","WorkFileUploadsGating","ChatStartPlanDialogHelper","WebMessengerConfirmBlockDialog","getPageIDFromThreadID","XEventCreateDialogController","XMessagingGroupOptionsDialogController","goURI","gkx"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("MercuryMessageObject").get(),k=c("MercuryThreadActions").get(),l=c("MercuryThreadIDMap").get(),m=c("MercuryThreads").get(),n=c("MercuryMessageActions").get(),o=c("ReactMenu").Item,p=c("React").PropTypes,q=c("React").createClass({displayName:"ChatTabMenu",_privacyActionController:undefined,linkRef:undefined,mixins:[c("ReactComponentWithPureRenderMixin")],propTypes:{autoFocus:p.bool,attachmentsShelf:p.object,nameConversationFunc:p.func,isGroupChat:p.bool,isEmptyChat:p.bool,hasMessageBlocked:p.bool,isEmptyConversation:p.bool,onMount:p.func,onSubmit:p.func,onUpdateAttachmentsShelf:p.func,onUploadFinished:p.func,otherUserID:p.string,sheetController:p.object.isRequired,showAddFriend:p.func,threadID:p.string.isRequired},getInitialState:function r(){return{url:null,privacyText:"",muted:false,showReportPageDialog:false}},getDefaultProps:function r(){return{show:true,isMuted:false,hasSwitchToWork:false}},componentDidMount:function r(){c("WebMessengerThreadPermalinks").getThreadURI(this.props.threadID,function(s){this.isMounted()&&!c("MercuryIDs").isLocalThread(this.props.threadID)&&this.setState({url:s})}.bind(this));if(!this.props.isGroupChat)this._privacyActionController=new(c("ChatPrivacyActionController"))(c("MercuryIDs").getUserIDFromThreadID(this.props.threadID),function(s){return this._updatePrivacyLink(s)}.bind(this));this.props.onMount&&this.props.onMount(this)},componentWillUnmount:function r(){this._privacyActionController&&this._privacyActionController.destroy()},_unmuteThread:function r(){k.unmute(this.props.threadID);c("Toggler").hide()},_togglePrivacyFunc:function r(){this._privacyActionController&&this._privacyActionController.togglePrivacy()},_renderFileUploader:function r(){return c("React").createElement(o,{className:"_37_x"},c("React").createElement(c("ShimButton.react"),{className:"_4q61 itemAnchor",inline:true,onClick:function(){return c("FantaMessageActions").openUploadFilePicker(this.props.threadID)}.bind(this)},i._("Add Files...")))},_fullConversationRedirect:function r(){c("goURI")(this.state.url)},_renderOpenFullConversation:function r(){if(this.state.url){var s=c("CurrentUser").isWorkUser()?i._("Open in Workplace Chat"):i._("Open in Messenger");return c("React").createElement(o,{href:this.state.url,onclick:this._fullConversationRedirect},s)}return null},_renderAddFriend:function r(){__p&&__p();if(!this.props.showAddFriend||c("getPageIDFromThreadID")(this.props.threadID))return null;var s=m.getThreadMetaNow(this.props.threadID),t=c("MessengerAdminGroupUtils").shouldInvite(s),u=c("MessengerAdminGroupUtils").isGroupChat(s),v=void 0;if(c("WorkModeConfig").is_work_user)v=i._("Add Coworkers to Chat...");else if(t)v=i._("Invite Friends to Chat...");else if(u)v=i._("Add Group Members to Chat...");else v=i._("Add Friends to Chat...");return c("React").createElement(o,{onclick:this.props.showAddFriend},v)},_renderTogglePrivacy:function r(){if(!this.props.isGroupChat&&this.state.privacyText)return c("React").createElement(o,{onclick:this._togglePrivacyFunc},this.state.privacyText);return null},_canEditNickname:function r(){if(c("getPageIDFromThreadID")(this.props.threadID))return false;var s=m.getThreadMetaNow(this.props.threadID),t=c("CurrentUser").getID(),u=s&&s.participants&&t&&c("MessengerAdminGroupUtils").canUpdateThreadCustomization(s,t);return!!u},_renderEditNickname:function r(){if(!this._canEditNickname())return null;return c("React").createElement(o,{onclick:this._showEditNicknameDialog},i._("Edit Nicknames"))},_renderChangeColor:function r(){if(c("getPageIDFromThreadID")(this.props.threadID))return null;var s=m.getThreadMetaNow(this.props.threadID),t=c("MercuryIDs").getUserIDFromParticipantID(c("MercuryViewer").getID()),u=s&&t&&c("MessengerAdminGroupUtils").canUpdateThreadCustomization(s,t);if(u&&c("ChatConfig").get("chat_tab_custom_color"))return c("React").createElement(o,{onclick:this._showCustomColorDialog},i._("Change Color..."));return null},_renderMuteConversation:function r(){if(!this.props.isMuted){var s=c("MercuryThreadMuter").showMuteChangeDialog.bind(null,this.props.threadID,this.linkRef);return c("React").createElement(o,{onclick:s},i._("Mute Conversation..."))}else return c("React").createElement(o,{onclick:this._unmuteThread},i._("Unmute Conversation"))},_renderDeleteConversation:function r(){return c("React").createElement(o,{onclick:this._deleteConversation},i._("Delete Conversation..."))},_renderReportSpam:function r(){var s=c("getPageIDFromThreadID")(this.props.threadID),t=i._("Report...");if(s)return c("React").createElement(o,{onclick:this._reportPageClicked},c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("div",null),bootloadLoader:c("JSResource")("MNCommerceReportConversationDialog.react").__setRef("ChatTabMenu.react"),pageID:s,showDialog:this.state.showReportPageDialog,onToggle:this._handleReportPageToggle}),t);if(!this.props.isGroupChat&&!c("CurrentUser").isWorkUser())return c("React").createElement(o,{onclick:this._reportSpamClicked},t);return null},_manageMessagesItem:function r(){if(this.props.isBusinessEnabled)return c("React").createElement(o,{onclick:this._messageManageClicked},i._("Manage Messages..."));return null},_manageReviewItem:function r(){if(!this.props.isBusinessEnabled)return null;return c("React").createElement(o,{onclick:this._reviewClicked},i._("Leave Feedback"))},_blockMessagesItem:function r(){if(this.props.isBusinessEnabled||this.props.otherUserID&&this.props.otherUserID===c("CurrentUser").getID())return null;if(!this.props.isGroupChat&&!this.props.hasMessageBlocked&&!this.props.isEmptyConversation&&!c("CurrentUser").isWorkUser())return c("React").createElement(o,{onclick:this._messageBlockedClicked},i._("Block Messages..."));if(!this.props.isGroupChat&&this.props.hasMessageBlocked)return c("React").createElement(o,{onclick:this._messageUnblockedClicked},i._("Unblock Messages..."));return null},_ignoreMessagesItem:function r(){if(this.props.isBusinessEnabled||this.props.otherUserID&&this.props.otherUserID===c("CurrentUser").getID()||this.props.hasMessageBlocked||c("CurrentUser").isWorkUser())return null;if(this.props.isGroupChat&&!c("gkx")("AT6sQjs7GRVhEipNW3TkmIJi_BHZa2KKyD-Mi9QicLxYmeTJYm7WWpq-_Rh-wyDoXW1BNvzANnO7tf1hMqNgPGMF"))return null;return c("React").createElement(o,{onclick:this._messageIgnoreClicked},i._("Ignore Messages..."))},_renderCreateGroup:function r(){if(this.props.isGroupChat)return c("React").createElement(o,{onclick:this._createGroupClicked},i._("Create Group"));return null},_renderCreateEvent:function r(){if(this.props.isGroupChat)return c("React").createElement(o,{onclick:this._createEventClicked},i._("Create Event"));return null},_renderCreatePlan:function r(){if(c("getPageIDFromThreadID")(this.props.threadID))return null;var s=c("EventReminderStateStore").getEvent(this.props.threadID);if(!(s&&s.exists)&&c("EventRemindersGating").isCreateAllowed){var t=c("EventRemindersGating").shouldUseNewName?i._("Start Plan"):i._("Create Reminder");return c("React").createElement(o,{onclick:this._onEventPlanButtonClicked},t)}return null},_renderSwitchToWork:function r(){if(this.props.hasSwitchToWork)return c("React").createElement(o,{onclick:this._switchToWorkUserClicked},i._("Move to Workplace"));return null},_renderConversationName:function r(){var s=m.getThreadMetaNow(this.props.threadID),t=c("MercuryIDs").getUserIDFromParticipantID(c("MercuryViewer").getID()),u=s&&t&&c("MessengerAdminGroupUtils").canUpdateThreadCustomization(s,t)&&this.props.isGroupChat&&!m.isEmptyLocalThread(this.props.threadID);if(u)return c("React").createElement(o,{onclick:this.props.nameConversationFunc},i._("Edit Conversation Name"));return null},_renderLeaveConversation:function r(){if(this.props.isGroupChat)return c("React").createElement(o,{onclick:this._unsubscribeLinkClicked},i._("Leave Conversation..."));return null},_renderPeopleList:function r(){if(this.props.isGroupChat&&!m.isEmptyLocalThread(this.props.threadID))return c("React").createElement(o,{onclick:this._showParticipants},i._("Edit Participants..."));return null},_renderGroupOptions:function r(){var s=m.getThreadMetaNow(this.props.threadID),t=c("MercuryIDs").getUserIDFromParticipantID(c("MercuryViewer").getID());if(s&&t&&this.props.isGroupChat&&c("MessengerAdminGroupUtils").canSeeGroupOptions(true,s,t))return c("React").createElement(o,{onclick:this._showGroupOptions},i._("View Group Options"));return null},_renderToggleSecretMode:function r(){if(this.props.hasSecretModeOn)return c("React").createElement(o,{onclick:this._secretModeTurnOff},i._("Turn off disappearing messages"));return null},render:function r(){var s=this._renderReportSpam(),t=this._blockMessagesItem(),u=this._ignoreMessagesItem(),v=this._manageMessagesItem(),w=this._manageReviewItem(),x=this._renderCreateGroup(),y=this._renderCreateEvent(),z=this._renderGroupOptions(),A=c("React").createElement(c("ReactMenu"),{className:"chatReact"+(!this.props.show?" hidden_elem":"")},this._renderOpenFullConversation(),c("WorkFileUploadsGating").canUploadFiles?this._renderFileUploader():null,this._renderToggleSecretMode(),this._renderAddFriend(),this._renderTogglePrivacy(),this._renderConversationName(),this._renderPeopleList(),c("React").createElement(c("MenuSeparator.react"),null),z,z?c("React").createElement(c("MenuSeparator.react"),null):null,this._renderEditNickname(),this._renderChangeColor(),this._renderSwitchToWork(),this._renderMuteConversation(),this._renderDeleteConversation(),this._renderLeaveConversation(),this._renderCreatePlan(),s||t||u||v||w?c("React").createElement(c("MenuSeparator.react"),null):null,u,t,v,w,s,x||y?c("React").createElement(c("MenuSeparator.react"),null):null,x,y),B=i._("Options"),C=c("TrackingNodes").getTrackingInfo(c("TrackingNodes").types.DROPDOWN_BUTTON);return c("React").createElement(c("PopoverMenu.react"),{menu:A,ref:"menu"},c("React").createElement(c("AutoFocusableLink.react"),{autoFocus:this.props.autoFocus,"data-ft":C,"data-hover":"tooltip","aria-label":B,"data-tooltip-alignh":"center","data-tooltip-content":B,className:"button"+(this.props.isEmptyChat?" hidden_elem":"")+" _3olv _1ll-",ref:function(D){return this.linkRef=c("ReactDOM").findDOMNode(D)}.bind(this),role:"button"}))},_updatePrivacyLink:function r(s){__p&&__p();var t=void 0;if(s==c("ChatPrivacyActionController").OFFLINE){t=i._("Go online");this.setState({privacyText:t});return}if(this.props.isGroupChat||this.props.otherUserID===undefined)return;var u="fbid:".concat(this.props.otherUserID);c("MercuryParticipants").get(u,function(v){if(!v.is_friend)t=null;else if(s==c("ChatPrivacyActionController").BLOCKED)t=i._("Turn On Chat for {name}",[i.param("name",v.short_name)]);else if(c("gkx")("AT6XJNxwV6KaJzyxn6EDe3Tm_qRFKRqe2qkOS_4ZLz8D2JxuLFBXYKOl65GgbN3cStXtdJ_4PUESVZvXZJiurCDl"))t="";else t=i._("Turn Off Chat for {name}",[i.param("name",v.short_name)]);this.setState({privacyText:t})}.bind(this))},_showEditNicknameDialog:function r(){var s=c("MercuryIDs").getUserIDFromParticipantID(c("MercuryViewer").getID());if(s)c("EditChatTabNicknamesDialog").show(this.props.threadID,s,this.linkRef)},_showCustomColorDialog:function r(){c("ChangeChatTabColorDialog").show(this.props.threadID,this.linkRef)},_showParticipants:function r(){l.getServerIDFromClientID(this.props.threadID,function(s){c("AsyncDialog").send(new(c("AsyncRequest"))(new(c("URI"))("/ajax/browser/dialog/multichat_members/").addQueryData({id:s})))})},_unsubscribeLinkClicked:function r(){__p&&__p();var s=[];s.push({name:"unsubscribe",label:i._("Leave Conversation"),handler:function(){return this._unsubscribeToThread()}.bind(this)});s.push(c("Dialog").CANCEL);var t=void 0;m.getThreadMeta(this.props.threadID,function(u){if(u.admin_ids&&u.admin_ids.indexOf(c("MercuryViewer").getID())!==-1)t=i._("Leaving this group will remove you as an owner and allow other members to manage the group. You will no longer be able to send and receive messages.");else t=i._("You will stop receiving messages from this conversation and people will see that you left.")});new(c("Dialog"))().setTitle(i._("Leave Conversation?")).setBody(t).setButtons(s).show()},_unsubscribeToThread:function r(){if(!m.isEmptyLocalThread(this.props.threadID)){var s=j.constructLogMessageObject(c("MercurySourceType").CHAT_WEB,this.props.threadID,c("MercuryLogMessageType").UNSUBSCRIBE,{removed_participants:[c("MercuryViewer").getID()]});n.send(s)}c("FantaTabActions").closeTab(this.props.threadID);return true},_deleteConversation:function r(){c("WebMessengerDeleteThreadDialog").show(this.props.threadID,function(){return c("FantaTabActions").deleteTab(this.props.threadID)}.bind(this),null,this.linkRef)},_reportSpamClicked:function r(){var s=new(c("URI"))("/ajax/chat/report.php").addQueryData({id:this.props.otherUserID}).addQueryData({src:"top_report_link"});if(c("NFXChatHeadGK").result)s=c("XNFXStartForMessageThreadController").getURIBuilder().setString("thread_fbid",this.props.otherUserID).setEnum("location","www_chat_head").getURI();c("AsyncDialog").send(new(c("AsyncRequest"))(s))},_reportPageClicked:function r(){this.setState({showReportPageDialog:true})},_handleReportPageToggle:function r(){this.setState({showReportPageDialog:false})},_messageBlockedClicked:function r(){if(c("MercuryConfig").WMBF)k.blockMessages(this.props.threadID,this._hanldeAfterBlock);else k.blockMessages(this.props.threadID)},_hanldeAfterBlock:function r(){c("WebMessengerConfirmBlockDialog").show();var s=c("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,c("CurrentUser").getID());k.changeFolder(this.props.threadID,c("MessagingTag").OTHER);c("FantaTabActions").closeTab(this.props.threadID);new(c("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_block_request").setThreadID(c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(c("MessagingTag").INBOX).setThreadKey(s).setEntryPoint(null).log()},_messageManageClicked:function r(){var s=function s(t,u){return c("MNCommercePromotionBlockDataManager").block(t,u)},t=c("MercuryIDs").getUserIDFromThreadID(this.props.threadID);c("MNCommerceDialogStateActions").showDialog(c("MNCommercePromotionManageBlockDialogContainer.react"),{pageID:t,onConfirmButtonClick:s})},_messageIgnoreClicked:function r(){k.ignoreMessages(this.props.isGroupChat?c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID):c("MercuryIDs").getUserIDFromThreadID(this.props.threadID))},_reviewClicked:function r(){var s=function s(t,u,v){if(u===0)return;c("MessengerPlatformBotReviewWriteDataManager").review(t,u,v.trim())},t=c("MercuryIDs").getUserIDFromThreadID(this.props.threadID);c("MNCommerceDialogStateActions").showDialog(c("MNCommerceReviewDialogContainer.react"),{pageID:t,onConfirmButtonClick:s})},_messageUnblockedClicked:function r(){k.unblockMessages(this.props.threadID)},_secretModeTurnOff:function r(){k.turnOffSecretMode(this.props.threadID)},_secretModeTurnOn:function r(){k.turnOnSecretMode(this.props.threadID)},_showGroupOptions:function r(){m.getThreadMeta(this.props.threadID,function(s){if(!s.is_canonical){var t=c("XMessagingGroupOptionsDialogController").getURIBuilder().setString("thread_fbid",s.thread_fbid).getURI();c("AsyncDialog").send(new(c("AsyncRequest"))(t))}})},_createGroupClicked:function r(){__p&&__p();m.getThreadMeta(this.props.threadID,function(s){if(!s.is_canonical){var t=new(c("URI"))(c("GroupsActionURIConstants").CREATE_GROUP_URI).addQueryData({ref:"web_messenger_dock",parent_id:"0"}),u=s.participants.map(function(v){return c("MercuryIDs").getUserIDFromParticipantID(v)}).filter(function(v){return v});t.addQueryData({members:u});if(s.name)t.addQueryData({name:s.name});c("AsyncDialog").send(new(c("AsyncRequest"))(t))}})},_createEventClicked:function r(){m.getThreadMeta(this.props.threadID,function(s){if(!s.is_canonical){var t=s.participants.map(function(v){return c("MercuryIDs").getUserIDFromParticipantID(v)}).filter(function(v){return v}),u=c("XEventCreateDialogController").getURIBuilder().setString("acontext",JSON.stringify({})).setIntVector("invite_ids",t).getURI();c("AsyncDialog").send(new(c("AsyncRequest"))(u))}})},_switchToWorkUserClicked:function r(){var s=[];s.push({name:"move",label:i._("Move Conversation"),handler:function(){return this._switchToWork()}.bind(this)});s.push(c("Dialog").CANCEL);var t=i._("Move Conversation to Workplace?"),u=i._("Do you want to move this conversation to Workplace?");new(c("Dialog"))().setTitle(t).setBody(u).setButtons(s).show()},_switchToWork:function r(){if(!m.isEmptyLocalThread(this.props.threadID)){var s=j.constructLogMessageObject(c("MercurySourceType").CHAT_WEB,this.props.threadID,c("MercuryLogMessageType").SWITCH_TO_WORK,{removed_participants:[c("MercuryViewer").getID()]});n.send(s)}c("FantaTabActions").closeTab(this.props.threadID);return true},open:function r(){this.refs.menu.showPopover()},_onEventPlanButtonClicked:function r(){c("ChatStartPlanDialogHelper").showDialog(this.props.threadID)}});f.exports=q}),null);